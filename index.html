<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ultimate Pro Hub - Working </title>
    <!-- Firebase SDKs (v8 compatibility) -->
    <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-auth.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-database.js"></script>
    <style>
        /* --- Global Styles --- */
        :root {
            --bg-dark: #0d1117; --bg-primary: #161b22; --bg-secondary: #21262d;
            --border-color: #30363d; --text-primary: #c9d1d9; --text-secondary: #8b949e;
            --accent-blue: #58a6ff; --accent-green: #3fb950; --accent-red: #f85149;
            --accent-purple: #a371f7; --accent-yellow: #d29922;
        }
        @import url('https://fonts.googleapis.com/css2?family=Roboto:wght@400;500;700&display=swap');
        body {
            font-family: 'Roboto', sans-serif; background-color: var(--bg-dark); color: var(--text-primary);
            margin: 0; display: flex; justify-content: center; align-items: flex-start; min-height: 100vh; padding-top: 10px; padding-bottom: 10px;
        }
        .main-wrapper { width: 100%; max-width: 420px; background-color: var(--bg-primary); border: 1px solid var(--border-color); border-radius: 10px; height: 95vh; display: flex; flex-direction: column; overflow: hidden; position: relative; }
        .top-bar { display: flex; align-items: center; padding: 10px 15px; background-color: var(--bg-secondary); border-bottom: 1px solid var(--border-color); }
        .menu-btn { background: none; border: none; color: var(--text-primary); font-size: 1.8em; cursor: pointer; }
        .top-bar h1 { font-size: 1.2em; margin: 0 auto; }
        #mute-btn { margin-left: auto; font-size: 1.5em; padding: 0 10px; }
        .page { display: none; padding: 15px; flex-grow: 1; overflow-y: auto; }
        .page.active { display: block; animation: fadeIn 0.3s; }
        @keyframes fadeIn { from { opacity: 0; } to { opacity: 1; } }

        /* --- Sidebar & General UI --- */
        .sidebar { position: fixed; top: 0; left: -280px; width: 250px; height: 100%; background-color: var(--bg-secondary); z-index: 1001; transition: left 0.3s ease-in-out; border-right: 1px solid var(--border-color); display: flex; flex-direction: column; }
        .sidebar.open { left: 0; }
        .sidebar-header { padding: 20px; text-align: center; border-bottom: 1px solid var(--border-color); }
        .sidebar-nav { flex-grow: 1; display: flex; flex-direction: column; overflow-y: auto; }
        .sidebar-nav a { display: flex; align-items: center; gap: 15px; padding: 15px 20px; color: var(--text-primary); text-decoration: none; border-bottom: 1px solid var(--border-color); transition: background-color 0.2s; }
        .sidebar-nav a:hover { background-color: var(--bg-dark); }
        .sidebar-nav a#logout-link { margin-top: auto; border-top: 1px solid var(--border-color); }
        .sidebar-overlay { position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.5); z-index: 1000; opacity: 0; visibility: hidden; transition: opacity 0.3s; }
        .sidebar-overlay.open { opacity: 1; visibility: visible; }
        .btn { padding: 10px 15px; border: none; border-radius: 6px; font-size: 1em; font-weight: 500; cursor: pointer; transition: all 0.2s; }
        .btn:disabled { background-color: var(--text-secondary) !important; cursor: not-allowed; }
        .btn-green { background-color: var(--accent-green) !important; color: white !important; }
        .btn-primary { background-color: var(--accent-blue) !important; color: white !important; }
        .btn-red { background-color: var(--accent-red) !important; color: white !important; }
        .input-group { margin-bottom: 15px; }
        .input-group label { display: block; margin-bottom: 5px; color: var(--text-secondary); font-size: 0.9em; }
        .input-group input { width: 100%; padding: 10px; font-size: 1em; border-radius: 6px; border: 1px solid var(--border-color); background-color: var(--bg-dark); color: var(--text-primary); box-sizing: border-box; }
        .input-group select {
            width: 100%; padding: 10px; font-size: 1em; border-radius: 6px; 
            border: 1px solid var(--border-color); background-color: var(--bg-dark); 
            color: var(--text-primary); box-sizing: border-box;
            -webkit-appearance: none; -moz-appearance: none; appearance: none;
            background-image: url("data:image/svg+xml;charset=UTF-8,%3csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24' fill='none' stroke='%23c9d1d9' stroke-width='2' stroke-linecap='round' stroke-linejoin='round'%3e%3cpolyline points='6 9 12 15 18 9'%3e%3c/polyline%3e%3c/svg%3e");
            background-repeat: no-repeat;
            background-position: right 10px center;
            background-size: 1em;
        }

        /* --- Loader Styles --- */
        #loader-overlay { position: fixed; top: 0; left: 0; width: 100%; height: 100%; background-color: var(--bg-dark); display: flex; justify-content: center; align-items: center; z-index: 10000; transition: opacity 0.5s; }
        .loader { border: 5px solid var(--bg-secondary); border-top: 5px solid var(--accent-blue); border-radius: 50%; width: 50px; height: 50px; animation: spin 1s linear infinite; }
        .loader-small { margin: 20px auto; border: 3px solid var(--bg-secondary); border-top: 3px solid var(--accent-blue); border-radius: 50%; width: 25px; height: 25px; animation: spin 1s linear infinite; }
        @keyframes spin { 0% { transform: rotate(0deg); } 100% { transform: rotate(360deg); } }

        /* --- Auth Page Styles --- */
        #auth-container { position: fixed; top: 0; left: 0; width: 100%; height: 100%; background-color: var(--bg-dark); z-index: 9999; display: flex; justify-content: center; align-items: center; }
        #auth-box { width: 90%; max-width: 380px; padding: 25px; background-color: var(--bg-primary); border: 1px solid var(--border-color); border-radius: 10px; }
        #auth-box h2 { text-align: center; margin-top: 0; margin-bottom: 20px; color: var(--text-primary); }
        .auth-error { color: var(--accent-red); background-color: rgba(248, 81, 73, 0.1); border: 1px solid var(--accent-red); border-radius: 6px; padding: 10px; margin-bottom: 15px; font-size: 0.9em; text-align: center; display: none; }
        .auth-toggle-text { text-align: center; font-size: 0.9em; margin-top: 20px; color: var(--text-secondary); }
        .auth-toggle-text a { color: var(--accent-blue); text-decoration: none; font-weight: 500; }

        /* --- Home Page --- */
        .game-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 15px; margin-bottom: 25px; }
        .game-card { background-color: var(--bg-secondary); border-radius: 10px; padding: 20px; text-align: center; cursor: pointer; transition: transform 0.2s; border: 1px solid var(--border-color); }
        .game-card:hover { transform: translateY(-5px); }
        .game-card .icon { font-size: 2.5em; margin-bottom: 10px; }
        .promo-scroller-wrapper { overflow-x: auto; margin-bottom: 20px; display: none; -ms-overflow-style: none; scrollbar-width: none; }
        .promo-scroller-wrapper::-webkit-scrollbar { display: none; }
        .promo-scroller-inner { display: flex; gap: 10px; padding: 2px 0; }
        .promo-scroller-item { flex: 0 0 85%; max-width: 320px; }
        .promo-scroller-item img { width: 100%; height: auto; border-radius: 8px; border: 1px solid var(--border-color); display: block; }

        /* --- Wallet Page --- */
        .wallet-summary { background-color: var(--bg-secondary); padding: 20px; border-radius: 10px; text-align: center; margin-bottom: 20px; }
        .wallet-summary .balance { font-size: 2.5em; font-weight: 700; margin: 5px 0 20px 0; }
        .wallet-actions { display: flex; gap: 15px; } .wallet-actions .btn { flex: 1; }
        .transaction-history table { width: 100%; border-collapse: collapse; }
        .transaction-history th, .transaction-history td { padding: 12px 8px; text-align: left; border-bottom: 1px solid var(--border-color); font-size: 0.9em; }
        .tx-credit { color: var(--accent-green); } .tx-debit { color: var(--accent-red); }

        /* --- Leaderboard Page Styles --- */
        .leaderboard-table table { width: 100%; border-collapse: collapse; margin-top: 15px; }
        .leaderboard-table th, .leaderboard-table td { padding: 12px 10px; text-align: left; border-bottom: 1px solid var(--border-color); }
        .leaderboard-table th { color: var(--text-secondary); }
        .leaderboard-table td:nth-child(1) { font-weight: 700; color: var(--accent-yellow); text-align: center; width: 60px; }
        .leaderboard-table td:nth-child(3) { font-weight: 700; color: var(--accent-green); }
        .leaderboard-table tr:nth-child(1) td:nth-child(1)::before { content: 'ü•á '; }
        .leaderboard-table tr:nth-child(2) td:nth-child(1)::before { content: 'ü•à '; }
        .leaderboard-table tr:nth-child(3) td:nth-child(1)::before { content: 'ü•â '; }
        
        /* --- NEW: In-Game Balance Display --- */
        .game-header-balance {
            display: flex; justify-content: space-between; align-items: center;
            background-color: var(--bg-dark); padding: 8px 12px;
            border-radius: 8px; margin-bottom: 15px; border: 1px solid var(--border-color);
        }
        .game-header-balance span { font-size: 0.9em; color: var(--text-secondary); }
        .game-header-balance strong { font-size: 1.1em; color: var(--accent-green); }


        /* --- Game Result Dialog Styles (CT, Mines, and Generic) --- */
        .dialog-overlay { position: absolute; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.7); z-index: 3000; display: none; justify-content: center; align-items: center; padding: 15px; box-sizing: border-box; }
        .dialog-overlay.show { display: flex; animation: fadeIn 0.3s; }
        .ct-dialog-overlay { position: absolute; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.6); z-index: 2000; display: none; justify-content: center; align-items: center; }
        .ct-dialog-overlay.show { display: flex; animation: fadeIn 0.3s; }
        
        .ct-dialog, .generic-dialog { background: var(--bg-secondary); color: white; border-radius: 15px; width: 85%; max-width: 320px; text-align: center; position: relative; padding-top: 50px; box-shadow: 0 5px 20px rgba(0,0,0,0.4); border: 1px solid var(--border-color); }
        .ct-dialog-header, .generic-dialog-header { position: absolute; top: -35px; left: 50%; transform: translateX(-50%); }
        .ct-icon-badge, .generic-icon-badge { width: 70px; height: 70px; border-radius: 50%; border: 5px solid var(--bg-secondary); display: flex; justify-content: center; align-items: center; font-size: 2.5em; position: relative; }
        
        .win-dialog .ct-icon-badge, .generic-win-dialog .generic-icon-badge { background: linear-gradient(45deg, var(--accent-green), #86ef92); }
        .loss-dialog .ct-icon-badge, .generic-loss-dialog .generic-icon-badge { background: linear-gradient(45deg, var(--accent-red), #f88a84); }
        .mines-win-dialog .ct-icon-badge { background: linear-gradient(45deg, var(--accent-blue), #8dc4ff); }
        .mines-loss-dialog .ct-icon-badge { background: linear-gradient(45deg, var(--accent-red), #f88a84); }
        
        .ct-dialog-content, .generic-dialog-content { padding: 20px; }
        .ct-dialog-content h2, .generic-dialog-content h2 { margin-top: 0; margin-bottom: 15px; }
        .ct-lottery-results { margin-bottom: 20px; display: flex; align-items: center; justify-content: center; gap: 8px; font-size: 0.9em; color: var(--text-secondary); }
        .result-tag { background: var(--bg-dark); padding: 3px 8px; border-radius: 5px; color: var(--text-primary); font-weight: 500;}
        
        .ct-bonus-ticket, .generic-bonus-ticket { background-color: var(--bg-primary); border: 1px solid var(--border-color); border-radius: 10px; padding: 15px; margin-bottom: 20px; position: relative; border-top: 3px solid var(--accent-yellow); }
        .ct-bonus-ticket.loss-ticket, .generic-bonus-ticket.loss-ticket { border-top-color: var(--text-secondary); }
        .ct-bonus-ticket p, .generic-bonus-ticket p { margin: 0; color: var(--text-secondary); font-size: 0.9em; }
        .ct-bonus-ticket h3, .generic-bonus-ticket h3 { margin: 5px 0; font-size: 2em; }
        .win-dialog .ct-bonus-ticket h3, .generic-win-dialog .generic-bonus-ticket h3 { color: var(--accent-green); }
        .loss-dialog .ct-bonus-ticket h3, .generic-loss-dialog .generic-bonus-ticket h3 { color: var(--accent-red); }
        .mines-win-dialog .ct-bonus-ticket h3 { color: var(--accent-green); } .mines-loss-dialog .ct-bonus-ticket h3 { color: var(--text-secondary); }
        
        .ct-bonus-ticket .period-info { font-size: 0.8em; color: var(--text-secondary); margin-top: 10px; }
        .auto-close-info { font-size: 0.9em; opacity: 0.8; }
        .dialog-close { position: absolute; bottom: -50px; left: 50%; transform: translateX(-50%); background: none; border: 2px solid rgba(255,255,255,0.7); color: white; width: 30px; height: 30px; border-radius: 50%; font-size: 1.5em; line-height: 26px; cursor: pointer; }

        /* --- Deposit/Withdraw/Confirm Dialog Styles --- */
        .dialog-box { background: var(--bg-secondary); color: var(--text-primary); border-radius: 10px; width: 100%; max-width: 380px; padding: 20px; position: relative; border: 1px solid var(--border-color); box-shadow: 0 5px 20px rgba(0,0,0,0.4); }
        .dialog-box h2 { margin-top: 0; text-align: center; margin-bottom: 20px; }
        .dialog-close-btn { position: absolute; top: 5px; right: 10px; background: none; border: none; color: var(--text-secondary); font-size: 2em; cursor: pointer; line-height: 1; }
        .dialog-instructions { font-size: 0.9em; color: var(--text-secondary); margin: 15px 0 5px 0; }
        .upi-info { display: flex; align-items: center; gap: 10px; background: var(--bg-dark); padding: 10px; border-radius: 6px; font-weight: bold; font-family: monospace; font-size: 1.1em; }
        #upi-id-text { flex-grow: 1; color: var(--accent-yellow); }
        .btn-small { padding: 5px 10px; font-size: 0.8em; background-color: var(--bg-primary); color: var(--text-primary); border: 1px solid var(--border-color); border-radius: 4px; cursor: pointer; }
        .amount-selector { display: flex; gap: 10px; flex-wrap: wrap; margin: 10px 0; }
        .btn-amount { flex: 1 1 45%; padding: 8px; font-size: 1em; background-color: var(--bg-dark); color: var(--text-primary); border: 1px solid var(--border-color); border-radius: 6px; cursor: pointer; transition: background-color 0.2s; }
        .btn-amount:hover { background-color: var(--bg-primary); }
        .dialog-confirm-details { text-align: center; margin: 20px 0; font-size: 1.1em; line-height: 1.5; }
        .dialog-confirm-details strong { color: var(--accent-yellow); }
        .dialog-actions { display: flex; gap: 15px; margin-top: 25px; }
        .dialog-actions .btn { flex: 1; }

        /* --- Color Trading Game Styles --- */
        .ct-container { background-color: var(--bg-dark); padding: 15px; border-radius: 8px; }
        .ct-header { background: linear-gradient(135deg, var(--accent-red), #e4433c); color: white; padding: 15px; border-radius: 8px; margin-bottom: 20px; box-shadow: 0 4px 15px rgba(248, 81, 73, 0.2); }
        .ct-header-top { display: flex; justify-content: space-between; align-items: center; font-size: .9em; opacity: 0.9; }
        .ct-header-top span:last-child { cursor: pointer; background: rgba(255,255,255,0.15); padding: 4px 8px; border-radius: 12px; transition: background-color 0.2s; }
        .ct-header-top span:last-child:hover { background: rgba(255,255,255,0.3); }
        .ct-header-main { text-align: center; padding: 10px 0; }
        .ct-header-main .label { font-size: 1.1em; margin-bottom: 5px; opacity: 0.9; }
        .ct-header-main .timer { font-size: 2.8em; font-weight: 700; letter-spacing: 2px; margin: 0; }
        .ct-header-main .period { font-size: .9em; letter-spacing: 1px; opacity: 0.8; margin-top: 5px;}
        .ct-main-bets { display: grid; grid-template-columns: 1fr 1fr 1fr; gap: 10px; margin-bottom: 20px; }
        .ct-main-bets .btn { padding: 15px 0; font-size: 1.1em; font-weight: 700; text-transform: uppercase; }
        .ct-number-grid { display: grid; grid-template-columns: repeat(5, 1fr); gap: 10px; margin-bottom: 20px; }
        .ct-number-btn {
            aspect-ratio: 1/1;
            border-radius: 50%;
            border: none;
            display: flex;
            justify-content: center;
            align-items: center;
            background: transparent;
            cursor: pointer;
            transition: all 0.2s;
            padding: 0;
        }
        .ct-number-btn:hover { transform: scale(1.1); }
        .ct-number-btn img {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }
        .ct-bet-multipliers { display: flex; justify-content: space-around; margin-bottom: 20px; }
        .ct-bet-multipliers .btn { background-color: var(--bg-dark); color: var(--text-primary); }
        .ct-big-small-bet { display: flex; gap: 10px; margin-bottom: 20px; }
        .ct-big-small-bet .btn { flex: 1; padding: 15px 0; font-size: 1.1em; font-weight: 700; text-transform: uppercase; }
        .ct-history-tabs { display: flex; border-bottom: 1px solid var(--border-color); margin-bottom: 10px; }
        .ct-history-tabs .tab { padding: 10px 15px; cursor: pointer; color: var(--text-secondary); position: relative; }
        .ct-history-tabs .tab.active { color: var(--accent-blue); }
        .ct-history-tabs .tab.active::after { content:''; position: absolute; bottom: -1px; left: 0; right: 0; height: 2px; background-color: var(--accent-blue); }
        .ct-history-content { display: none; } .ct-history-content.active { display: block; }
        .ct-history-table table { width: 100%; text-align: center; }
        .ct-history-table th, .ct-history-table td { padding: 8px 5px; font-size: .9em; }
        
        /* --- Mines Game Styles (Improved) --- */
        @keyframes bombShake{0%,100%{transform:translateX(0)}20%,60%{transform:translateX(-5px)}40%,80%{transform:translateX(5px)}}
        @keyframes gridShake{0%,100%{transform:translate(0,0)}10%,30%,50%,70%,90%{transform:translate(-2px,-2px)}20%,40%,60%,80%{transform:translate(2px,2px)}}
        .mines-grid.shake-effect { animation:gridShake .4s cubic-bezier(.36,.07,.19,.97) both; }
        .mines-grid { display: grid; grid-template-columns: repeat(5, 1fr); gap: 8px; margin: 20px 0; perspective: 1000px; }
        .mine-tile {
            aspect-ratio: 1/1;
            background: linear-gradient(145deg, var(--accent-blue), #4a8cd1);
            box-shadow: 0 4px 8px rgba(0,0,0,0.4), inset 0px 2px 2px rgba(255,255,255,0.25);
            border-radius: 8px;
            cursor: pointer;
            transition: all .3s;
            display: flex;
            justify-content: center;
            align-items: center;
            font-size: 1.8em;
            transform-style: preserve-3d;
        }
        .mine-tile:hover { filter: brightness(1.2); transform: translateY(-3px); }
        .mine-tile.revealed { 
            transform: rotateY(180deg); 
            background: radial-gradient(circle, var(--bg-dark) 0%, var(--bg-secondary) 70%);
            box-shadow: inset 2px 2px 5px rgba(0,0,0,0.6); 
            cursor: default; 
        }
        .mine-tile .face { position: absolute; width: 100%; height: 100%; backface-visibility: hidden; display:flex; justify-content:center; align-items:center; }
        .mine-tile .back { transform: rotateY(180deg); }
        .mine-tile.gem .back::after { 
            content: ''; display: block; width: 75%; height: 75%;
            background-image: url('https://i.ibb.co/zYFnNDv/file-0000000077d061f8896b2157ca713029.png');
            background-size: contain; background-repeat: no-repeat; background-position: center;
        }
        .mine-tile.bomb .back::after { content:'üí£'; animation:bombShake .5s; }
        .mines-info { text-align: center; background-color: var(--bg-dark); padding: 10px; border-radius: 10px; margin: 15px 0; display: grid; grid-template-columns: 1fr 1fr; }
        .mines-info .label { font-size: 0.9em; color: var(--text-secondary); }
        .mines-info .value { color: var(--accent-green); font-weight: bold; font-size: 1.2em; }
        #mines_action_btn { width: 100%; padding: 15px; font-size: 1.2em; font-weight: 700; text-transform: uppercase; }
        
        /* --- Auto-bet Styles --- */
        .auto-toggle-container { display: flex; align-items: center; gap: 10px; margin: 15px 0 10px 0; background: var(--bg-dark); padding: 10px; border-radius: 8px; }
        .switch { position: relative; display: inline-block; width: 50px; height: 26px; }
        .switch input { opacity: 0; width: 0; height: 0; }
        .slider { position: absolute; cursor: pointer; top: 0; left: 0; right: 0; bottom: 0; background-color: var(--bg-secondary); transition: .4s; border: 1px solid var(--border-color); }
        .slider:before { position: absolute; content: ""; height: 18px; width: 18px; left: 4px; bottom: 4px; background-color: white; transition: .4s; }
        input:checked + .slider { background-color: var(--accent-green); }
        input:checked + .slider:before { transform: translateX(24px); }
        .slider.round { border-radius: 34px; } .slider.round:before { border-radius: 50%; }
        #mines_auto_panel, #ct_auto_panel { background-color: var(--bg-dark); padding: 10px 15px 1px 15px; border-radius: 8px; margin-bottom: 15px; }

        /* --- How To Play Dialog Styles --- */
        .ct-how-to-play-overlay { z-index: 3002; }
        .how-to-play-box .dialog-content { padding: 0 20px 20px 20px; text-align: left; max-height: 60vh; overflow-y: auto; }
        .how-to-play-box h3 { color: var(--accent-yellow); margin-top: 20px; border-bottom: 1px solid var(--border-color); padding-bottom: 5px; }
        .how-to-play-box p { color: var(--text-secondary); line-height: 1.6; font-size: 0.95em; }
        .how-to-play-box ul { list-style: none; padding-left: 0; }
        .how-to-play-box li { background: var(--bg-dark); margin-bottom: 8px; padding: 10px; border-radius: 6px; border-left: 3px solid var(--accent-blue); }
        .how-to-play-box strong { color: var(--text-primary); }

        /* --- Hotline (Slots) Game Styles --- */
        .hotline-reels { display: flex; justify-content: center; gap: 10px; margin: 25px 0; padding: 15px; background: var(--bg-dark); border-radius: 10px; }
        .hotline-reel { width: 80px; height: 80px; background: var(--bg-primary); border: 2px solid var(--border-color); border-radius: 10px; display: flex; justify-content: center; align-items: center; overflow: hidden; }
        .hotline-reel img { width: 60px; height: 60px; object-fit: contain; }
        .payout-table table { width: 100%; margin-top: 10px; border-collapse: collapse; }
        .payout-table th, .payout-table td { padding: 8px; text-align: center; border: 1px solid var(--border-color); vertical-align: middle; }
        .payout-table .symbol-column { display: flex; justify-content: center; align-items: center; gap: 5px; }
        .payout-table .symbol-column img { height: 24px; width: 24px; object-fit: contain; }
        
        /* --- Balloon Game Styles --- */
        @keyframes balloon-rise { 0% { transform: translateY(0) scale(1); } 100% { transform: translateY(-20px) scale(1.1); } }
        .balloon-display { text-align: center; margin: 20px 0; }
        .balloon-container { font-size: 6em; }
        .balloon-container.rising { animation: balloon-rise 2s ease-in-out infinite alternate; }
        .balloon-multiplier { font-size: 2.5em; font-weight: 700; color: var(--accent-green); margin-top: 10px; }
        .balloon-status { margin-top: 15px; font-size: 1.1em; color: var(--text-secondary); height: 25px; }

        /* --- Keno Game Styles --- */
        .keno-grid { display: grid; grid-template-columns: repeat(8, 1fr); gap: 5px; margin-bottom: 15px; }
        .keno-number { aspect-ratio: 1/1; border: 1px solid var(--border-color); border-radius: 6px; display: flex; justify-content: center; align-items: center; cursor: pointer; transition: background-color 0.2s; }
        .keno-number.selected { background-color: var(--accent-blue); color: white; }
        .keno-number.drawn { background-color: var(--accent-green); color: white; transform: scale(1.1); }
        .keno-number.matched { background: var(--accent-yellow); color: var(--bg-dark); font-weight: bold; }
        .keno-info { text-align: center; margin-bottom: 15px; color: var(--text-secondary); }

    </style>

  <!-- Premium Styles: Google Font, Gradient, Glassmorphism, Buttons, Shimmer -->
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap" rel="stylesheet">
  <style>
    :root {
      --bg-dark: #0d1117;
      --bg-glass: rgba(21, 25, 34, 0.6);
      --bg-primary: #161b22;
      --border-color: #30363d;
      --text-primary: #c9d1d9;
      --accent-blue: #58a6ff;
      --accent-green: #3fb950;
      --accent-red: #f85149;
      --accent-purple: #a371f7;
      --accent-yellow: #d29922;
    }
    body {
      font-family: 'Inter', sans-serif;
      background-color: var(--bg-dark);
      color: var(--text-primary);
      margin: 0;
      padding: 0;
    }
    .top-bar {
      background: linear-gradient(270deg, #ff416c, #ff4b2b, #1cb5e0, #000851);
      background-size: 800% 800%;
      animation: gradientBG 12s ease infinite;
    }
    @keyframes gradientBG {
      0% { background-position: 0% 50%; }
      50% { background-position: 100% 50%; }
      100% { background-position: 0% 50%; }
    }
    .sidebar {
      background: var(--bg-glass) !important;
      backdrop-filter: blur(12px);
      box-shadow: 0 8px 32px rgba(0, 0, 0, 0.4);
      border-right: 1px solid var(--border-color);
    }
    .btn {
      background: linear-gradient(to right, var(--accent-blue), var(--accent-green)) !important;
      color: #fff !important;
      padding: 12px 18px !important;
      border-radius: 8px !important;
      font-weight: 600 !important;
      border: none !important;
      transition: all 0.3s !important;
    }
    .btn:hover {
      transform: translateY(-2px);
      box-shadow: 0 8px 20px rgba(0,0,0,0.3);
    }
    .shimmer-loader {
      height: 8px;
      border-radius: 4px;
      background: linear-gradient(to right, #2a2e35 8%, #3a3f48 18%, #2a2e35 33%);
      background-size: 1000px 100%;
      animation: shimmerAnim 1.5s infinite linear;
      margin: 16px 0;
    }
    @keyframes shimmerAnim {
      0% { background-position: -1000px 0; }
      100% { background-position: 1000px 0; }
    }
    input, select {
      background: var(--bg-dark) !important;
      color: var(--text-primary) !important;
      border: 1px solid var(--border-color) !important;
      border-radius: 6px !important;
      padding: 10px !important;
    }
  </style>

</head>
<body>
  <div class="shimmer-loader"></div>

    <!-- Global Loader -->
    <div id="loader-overlay"><div class="loader"></div></div>

    <!-- Authentication Container -->
    <div id="auth-container" style="display: none;"><div id="auth-box"><div id="login-form"><h2>Login</h2><p class="auth-error" id="login-error"></p><div class="input-group"><label for="login-email">Email</label><input type="email" id="login-email" required></div><div class="input-group"><label for="login-password">Password</label><input type="password" id="login-password" required></div><button id="login-btn" class="btn btn-primary" style="width: 100%;">Login</button><p class="auth-toggle-text">No account? <a href="#" id="show-signup">Sign Up</a></p></div><div id="signup-form" style="display: none;"><h2>Sign Up</h2><p class="auth-error" id="signup-error"></p><div class="input-group"><label for="signup-email">Email</label><input type="email" id="signup-email" required></div><div class="input-group"><label for="signup-password">Password (min. 6 characters)</label><input type="password" id="signup-password" required></div><button id="signup-btn" class="btn btn-green" style="width: 100%;">Sign Up</button><p class="auth-toggle-text">Already have an account? <a href="#" id="show-login">Login</a></p></div></div></div>

    <!-- Main App Wrapper -->
    <div class="main-wrapper" style="display: none;">
        <div class="top-bar">
            <button class="menu-btn" onclick="toggleSidebar()">‚ò∞</button>
            <h1 id="page-title">Home</h1>
            <button id="mute-btn" class="menu-btn" style="margin-left: auto; font-size: 1.5em;">üîä</button>
        </div>
        <div class="sidebar" id="sidebar">
            <div class="sidebar-header"><h2>Pro Hub</h2></div>
            <nav class="sidebar-nav">
                <a href="#" class="nav-link active" data-page="home-page"><span>üè†</span> Home</a>
                <a href="#" class="nav-link" data-page="wallet-page"><span>üí∞</span> My Wallet</a>
                <a href="#" class="nav-link" data-page="leaderboard-page"><span>üèÜ</span> Leaderboard</a>
                <a href="#" class="nav-link" data-page="color-trading-page"><span>üé®</span> Color Trading</a>
                <a href="#" class="nav-link" data-page="mines-game-page"><span>üí£</span> Mines</a>
                <a href="#" class="nav-link" data-page="hotline-page"><span>üé∞</span> Hotline</a>
                <a href="#" class="nav-link" data-page="balloon-page"><span>üéà</span> Balloon</a>
                <a href="#" class="nav-link" data-page="keno-page"><span>üéüÔ∏è</span> Keno</a>
                <a href="#" id="logout-link"><span>üö™</span> Logout</a>
            </nav>
        </div>
        <div class="sidebar-overlay" id="sidebar-overlay" onclick="toggleSidebar()"></div>

        <!-- ========= PAGES ========= -->
        <div id="home-page" class="page active">
            <div id="promo-scroller-wrapper" class="promo-scroller-wrapper"><div id="promo-scroller-inner" class="promo-scroller-inner"></div></div>
            <h3>Popular Games</h3>
            <div class="game-grid">
                <div class="game-card" onclick="showPage('color-trading-page')"><div class="icon">üé®</div><h3>Color Trading</h3></div>
                <div class="game-card" onclick="showPage('mines-game-page')"><div class="icon">üí£</div><h3>Mines</h3></div>
            </div>
            <h3>More Games</h3>
            <div class="game-grid">
                <div class="game-card" onclick="showPage('hotline-page')"><div class="icon">üé∞</div><h3>Hotline</h3></div>
                <div class="game-card" onclick="showPage('balloon-page')"><div class="icon">üéà</div><h3>Balloon</h3></div>
                <div class="game-card" onclick="showPage('keno-page')"><div class="icon">üéüÔ∏è</div><h3>Keno</h3></div>
                <div class="game-card" onclick="alert('More games are on the way!')"><div class="icon">‚ú®</div><h3>Coming Soon</h3></div>
            </div>
        </div>

        <div id="wallet-page" class="page">
            <div class="wallet-summary"><p class="label">Total Balance</p><p class="balance">‚Çπ<span id="wallet_balance">0.00</span></p><div class="wallet-actions"><button id="deposit-btn" class="btn btn-green">Deposit</button><button id="withdraw-btn" class="btn btn-primary">Withdraw</button></div></div>
            <h3>Transaction History</h3><div class="transaction-history"><table><thead><tr><th>Description</th><th>Amount</th><th>Date</th></tr></thead><tbody id="transaction_history_body"></tbody></table></div>
        </div>
        
        <div id="leaderboard-page" class="page">
            <h3>üèÜ Top Players</h3><p style="color: var(--text-secondary); font-size: 0.9em;">Leaderboard of the top players by balance. Updates in real-time.</p><div class="leaderboard-table"><table><thead><tr><th>Rank</th><th>Player</th><th>Balance</th></tr></thead><tbody id="leaderboard_body"></tbody></table></div>
        </div>

        <div id="color-trading-page" class="page">
            <div class="game-header-balance"><span>Balance:</span><strong class="game-balance-value">‚Çπ0.00</strong></div>
            <div class="ct-container">
                <div class="ct-header"><div class="ct-header-top"><span>üèÜ Win Go 1Min</span><span id="ct_how_to_play_btn">‚ìò How to play</span></div><div class="ct-header-main"><p class="label">Time remaining</p><p class="timer" id="ct_timer">00:00</p><p class="period" id="ct_period">202312...</p></div></div>
                <div class="input-group"><input type="number" id="ct_bet_amount" placeholder="Enter bet amount" value="10"></div>
                <div class="ct-main-bets"><button class="btn btn-green" onclick="ct_placeBet('color', 'Green')">Green</button><button class="btn btn-red" onclick="ct_placeBet('color', 'Red')">Red</button><button class="btn" style="background-color: var(--accent-purple);" onclick="ct_placeBet('color', 'Violet')">Violet</button></div>
                <div class="ct-number-grid" id="ct_number_grid"></div>
                <div class="ct-bet-multipliers"><button class="btn" onclick="ct_multiplyBet(1)">x1</button><button class="btn" onclick="ct_multiplyBet(5)">x5</button><button class="btn" onclick="ct_multiplyBet(10)">x10</button><button class="btn" onclick="ct_multiplyBet(20)">x20</button><button class="btn" onclick="ct_multiplyBet(50)">x50</button><button class="btn" onclick="ct_multiplyBet(100)">x100</button></div>
                <div class="ct-big-small-bet"><button class="btn" style="background-color: var(--accent-yellow);" onclick="ct_placeBet('size', 'Big')">Big</button><button class="btn" style="background-color: var(--accent-blue);" onclick="ct_placeBet('size', 'Small')">Small</button></div>
                <div class="auto-toggle-container"><label class="switch"><input type="checkbox" id="ct_auto_toggle"><span class="slider round"></span></label><span>Enable Auto Play</span></div>
                <div id="ct_auto_panel" style="display: none;"><div class="input-group"><label for="ct_auto_rounds">Number of Rounds</label><input type="number" id="ct_auto_rounds" value="10" min="1"></div><div class="input-group"><label for="ct_auto_strategy">Betting Strategy</label><select id="ct_auto_strategy"><option value="Green">Always Green</option><option value="Red">Always Red</option><option value="Violet">Always Violet</option><option value="Big">Always Big</option><option value="Small">Always Small</option><option value="random_color">Random Color (G/R/V)</option><option value="random_number">Random Number (0-9)</option></select></div><button id="ct_auto_action_btn" class="btn btn-green" style="width:100%; margin-bottom:15px;">Start Auto Play</button></div>
                <div class="ct-history-tabs"><div class="tab active" data-tab="game_history">Game history</div><div class="tab" data-tab="my_history">My history</div><div class="tab" data-tab="all_bets_history">All Bets</div></div>
                <div id="game_history" class="ct-history-content active"><div class="ct-history-table"><table><thead><tr><th>Period</th><th>Number</th><th>Size</th><th>Result</th></tr></thead><tbody id="ct_game_history_body"></tbody></table></div></div>
                <div id="my_history" class="ct-history-content"><div class="ct-history-table"><table><thead><tr><th>Period</th><th>Select</th><th>Amount</th><th>Result</th></tr></thead><tbody id="ct_my_history_body"></tbody></table></div></div>
                <div id="all_bets_history" class="ct-history-content"><div class="ct-history-table"><table><thead><tr><th>Email</th><th>Selection</th><th>Amount</th></tr></thead><tbody id="ct_all_bets_history_body"></tbody></table></div></div>
            </div>
        </div>

        <div id="mines-game-page" class="page">
            <div class="game-header-balance"><span>Balance:</span><strong class="game-balance-value">‚Çπ0.00</strong></div>
            <div class="input-group"><label for="mines_betAmount">Bet Amount</label><input type="number" id="mines_betAmount" value="10"></div>
            <div class="input-group"><label for="mines_mineCount">Mines (1-20)</label><input type="number" id="mines_mineCount" value="5" min="1" max="20"></div>
            <div class="auto-toggle-container"><label class="switch"><input type="checkbox" id="mines_auto_toggle"><span class="slider round"></span></label><span>Enable Auto Bet</span></div>
            <div id="mines_auto_panel" style="display: none;"><div class="input-group"><label for="mines_auto_games">Number of Games</label><input type="number" id="mines_auto_games" value="10" min="1"></div><div class="input-group"><label for="mines_auto_picks">Gems to Pick per Game</label><input type="number" id="mines_auto_picks" value="3" min="1" max="24"></div></div>
            <div class="mines-info"><div><span class="label">Next Profit</span><p class="value" id="mines_next_profit">--</p></div><div><span class="label">Total Profit</span><p class="value" id="mines_total_profit">--</p></div></div>
            <div class="mines-grid" id="mines_grid"></div><button id="mines_action_btn" class="btn"></button>
        </div>

        <div id="hotline-page" class="page">
            <div class="game-header-balance"><span>Balance:</span><strong class="game-balance-value">‚Çπ0.00</strong></div>
            <h3>üé∞ Hotline Slots</h3>
            <p style="color: var(--text-secondary); text-align:center; margin-bottom: 20px;">Match three symbols to win!</p>
            <div class="hotline-reels">
                <div class="hotline-reel" id="hotline_reel1"><img src="https://i.ibb.co/bgTQ8mzw/file-00000000824461f8a0e0ea62c52ee25b.png"></div>
                <div class="hotline-reel" id="hotline_reel2"><img src="https://i.ibb.co/wr8pkJkG/file-0000000075d8622f9ecf6665274a29b4.png"></div>
                <div class="hotline-reel" id="hotline_reel3"><img src="https://i.ibb.co/MD22rXYB/file-00000000ae1061f8acd84b9b9a00963a.png" alt="diamond"></div>
            </div>
            <div class="input-group"><label for="hotline_bet_amount">Bet Amount</label><input type="number" id="hotline_bet_amount" value="10"></div>
            <button id="hotline_spin_btn" class="btn btn-green" style="width: 100%;">Spin</button>
            <div class="payout-table">
                <h4 style="margin-top: 25px;">Payouts</h4>
                <table>
                    <thead><tr><th>Symbols</th><th>Multiplier</th></tr></thead>
                    <tbody>
                        <tr><td class="symbol-column"><img src="https://i.ibb.co/wr8pkJkG/file-0000000075d8622f9ecf6665274a29b4.png"><img src="https://i.ibb.co/wr8pkJkG/file-0000000075d8622f9ecf6665274a29b4.png"><img src="https://i.ibb.co/wr8pkJkG/file-0000000075d8622f9ecf6665274a29b4.png"></td><td>5x</td></tr>
                        <tr><td class="symbol-column"><img src="https://i.ibb.co/bgTQ8mzw/file-00000000824461f8a0e0ea62c52ee25b.png" alt="cherry"><img src="https://i.ibb.co/bgTQ8mzw/file-00000000824461f8a0e0ea62c52ee25b.png" alt="cherry"><img src="https://i.ibb.co/bgTQ8mzw/file-00000000824461f8a0e0ea62c52ee25b.png" alt="cherry"></td><td>10x</td></tr>
                        <tr><td class="symbol-column"><img src="https://i.ibb.co/MD22rXYB/file-00000000ae1061f8acd84b9b9a00963a.png" alt="diamond"><img src="https://i.ibb.co/MD22rXYB/file-00000000ae1061f8acd84b9b9a00963a.png" alt="diamond"><img src="https://i.ibb.co/MD22rXYB/file-00000000ae1061f8acd84b9b9a00963a.png" alt="diamond"></td><td>25x</td></tr>
                        <tr><td class="symbol-column"><img src="https://i.ibb.co/Xx8zKYV6/file-00000000ec7c61f5a7ee58f274e2b74d.png" alt="seven"><img src="https://i.ibb.co/Xx8zKYV6/file-00000000ec7c61f5a7ee58f274e2b74d.png" alt="seven"><img src="https://i.ibb.co/Xx8zKYV6/file-00000000ec7c61f5a7ee58f274e2b74d.png" alt="seven"></td><td>100x</td></tr>
                    </tbody>
                </table>
            </div>
        </div>

        <div id="balloon-page" class="page">
            <div class="game-header-balance"><span>Balance:</span><strong class="game-balance-value">‚Çπ0.00</strong></div>
            <h3>üéà Balloon</h3>
            <p style="color: var(--text-secondary); text-align:center;">Place a bet and cash out before the balloon pops!</p>
            <div class="balloon-display">
                <div class="balloon-container" id="balloon_icon">üéà</div>
                <div class="balloon-multiplier" id="balloon_multiplier">1.00x</div>
                <div class="balloon-status" id="balloon_status">Place your bet to start</div>
            </div>
            <div class="input-group"><label for="balloon_bet_amount">Bet Amount</label><input type="number" id="balloon_bet_amount" value="10"></div>
            <button id="balloon_action_btn" class="btn btn-green" style="width: 100%;">Bet</button>
        </div>

        <div id="keno-page" class="page">
            <div class="game-header-balance"><span>Balance:</span><strong class="game-balance-value">‚Çπ0.00</strong></div>
            <h3>üéüÔ∏è Keno</h3>
            <p style="color: var(--text-secondary); text-align:center;">Pick up to 10 numbers. More matches mean bigger wins!</p>
            <div class="keno-info" id="keno_info">Selected 0/10 numbers.</div>
            <div class="keno-grid" id="keno_grid"></div>
            <div class="input-group"><label for="keno_bet_amount">Bet Amount</label><input type="number" id="keno_bet_amount" value="10"></div>
            <button id="keno_draw_btn" class="btn btn-green" style="width: 100%;">Start Draw</button>
        </div>
        
        <!-- DIALOGS -->
        <div id="ct_dialog_overlay" class="ct-dialog-overlay"><div class="ct-dialog win-dialog" style="display:none;"><div class="ct-dialog-header"><div class="ct-icon-badge">üéâ</div></div><div class="ct-dialog-content"><h2>Congratulations</h2><div class="ct-lottery-results"><span>Lottery results:</span><span class="result-tag" id="ct_win_dialog_color"></span><span class="result-tag" id="ct_win_dialog_number"></span><span class="result-tag" id="ct_win_dialog_size"></span></div><div class="ct-bonus-ticket"><p>You Won</p><h3 id="ct_win_dialog_bonus"></h3><p class="period-info">Period: WinGo 1 Min <span id="ct_win_dialog_period"></span></p></div></div><button class="dialog-close" onclick="ct_hideDialog()">√ó</button></div><div class="ct-dialog loss-dialog" style="display:none;"><div class="ct-dialog-header"><div class="ct-icon-badge">üò¢</div></div><div class="ct-dialog-content"><h2>Better Luck Next Time!</h2><div class="ct-lottery-results"><span>Lottery results:</span><span class="result-tag" id="ct_loss_dialog_color"></span><span class="result-tag" id="ct_loss_dialog_number"></span><span class="result-tag" id="ct_loss_dialog_size"></span></div><div class="ct-bonus-ticket loss-ticket"><p>You Lost</p><h3 id="ct_loss_dialog_amount"></h3><p class="period-info">Period: WinGo 1 Min <span id="ct_loss_dialog_period"></span></p></div></div><button class="dialog-close" onclick="ct_hideDialog()">√ó</button></div></div>
        <div id="mines_dialog_overlay" class="ct-dialog-overlay"><div class="ct-dialog mines-win-dialog" style="display:none;"><div class="ct-dialog-header"><div class="ct-icon-badge">üíé</div></div><div class="ct-dialog-content"><h2>Cashed Out!</h2><div class="ct-bonus-ticket"><p>You Won</p><h3 id="mines_win_dialog_profit"></h3></div><p class="auto-close-info">Good Job!</p></div><button class="dialog-close" onclick="mines_hideDialog()">√ó</button></div><div class="ct-dialog mines-loss-dialog" style="display:none;"><div class="ct-dialog-header"><div class="ct-icon-badge">üí£</div></div><div class="ct-dialog-content"><h2>Boom! Game Over</h2><div class="ct-bonus-ticket loss-ticket"><p>You Lost</p><h3 id="mines_loss_dialog_amount"></h3></div><p class="auto-close-info">Better luck next time!</p></div><button class="dialog-close" onclick="mines_hideDialog()">√ó</button></div></div>
        
        <!-- NEW: Generic Win/Loss Dialog -->
        <div id="generic_dialog_overlay" class="ct-dialog-overlay">
            <div id="generic_dialog_box" class="generic-dialog">
                <div class="generic-dialog-header"><div id="generic_dialog_icon" class="generic-icon-badge"></div></div>
                <div class="generic-dialog-content">
                    <h2 id="generic_dialog_title"></h2>
                    <div class="generic-bonus-ticket">
                        <p id="generic_dialog_label"></p>
                        <h3 id="generic_dialog_amount"></h3>
                    </div>
                </div>
                <button class="dialog-close" onclick="hideGenericDialog()">√ó</button>
            </div>
        </div>

        <div id="deposit-dialog-overlay" class="dialog-overlay"><div class="dialog-box"><button id="close-deposit-dialog" class="dialog-close-btn">√ó</button><h2>Deposit Funds</h2><p class="dialog-instructions">1. Pay the desired amount to the UPI ID below.</p><div class="upi-info"><span id="upi-id-text">8699186810@fam</span><button id="copy-upi-btn" class="btn-small">Copy</button></div><p class="dialog-instructions">2. Select or enter the amount you paid (Min. ‚Çπ100).</p><div class="amount-selector"><button class="btn-amount">‚Çπ500</button><button class="btn-amount">‚Çπ600</button><button class="btn-amount">‚Çπ1000</button><button class="btn-amount">‚Çπ50000</button></div><div class="input-group"><label for="deposit-amount">Amount (‚Çπ)</label><input type="number" id="deposit-amount" placeholder="Enter amount paid" min="100"></div><p class="dialog-instructions">3. Enter the 12-digit UTR / Transaction ID.</p><div class="input-group"><label for="deposit-utr">UTR / Transaction ID</label><input type="text" id="deposit-utr" placeholder="Enter UTR from your payment app"></div><button id="submit-deposit-btn" class="btn btn-green" style="width: 100%;">I have paid, Submit Request</button></div></div>
        <div id="withdraw-dialog-overlay" class="dialog-overlay"><div class="dialog-box"><button id="close-withdraw-dialog" class="dialog-close-btn">√ó</button><h2>Withdraw Funds</h2><p class="dialog-instructions" style="margin-top:0;">Enter your UPI and amount (Min. ‚Çπ100).</p><div class="input-group"><label for="withdraw-upi">UPI ID (e.g., PhonePe/GPay/PayTM)</label><input type="text" id="withdraw-upi" placeholder="yourname@bank"></div><div class="input-group"><label for="withdraw-amount">Amount (‚Çπ)</label><input type="number" id="withdraw-amount" placeholder="Enter amount to withdraw"></div><p style="font-size: 0.9em; color: var(--text-secondary); margin-bottom: 20px; text-align: center;">Available: ‚Çπ<span id="withdraw-dialog-balance">0.00</span></p><button id="submit-withdraw-btn" class="btn btn-primary" style="width: 100%;">Submit Request</button></div></div>
        <div id="withdraw-confirm-dialog-overlay" class="dialog-overlay" style="z-index: 3001;"><div class="dialog-box"><h2>Confirm Withdrawal</h2><p class="dialog-confirm-details">You are about to withdraw <strong id="confirm-withdraw-amount"></strong> to the UPI ID <strong id="confirm-withdraw-upi"></strong>.<br>This action cannot be undone.</p><div class="dialog-actions"><button id="cancel-withdraw-confirmation" class="btn btn-red">Cancel</button><button id="confirm-withdraw-btn" class="btn btn-green">Confirm</button></div></div></div>
        <div id="ct-confirm-dialog-overlay" class="dialog-overlay" style="z-index: 3001;"><div class="dialog-box"><h2>Confirm Bet</h2><p class="dialog-confirm-details">Are you sure you want to place a bet of <strong id="confirm-ct-bet-amount"></strong> on <strong id="confirm-ct-bet-selection"></strong>?</p><div class="dialog-actions"><button id="cancel-ct-confirmation" class="btn btn-red">Cancel</button><button id="confirm-ct-bet-btn" class="btn btn-green">Confirm Bet</button></div></div></div>
        <div id="ct-how-to-play-overlay" class="dialog-overlay ct-how-to-play-overlay"><div class="dialog-box how-to-play-box"><button id="close-how-to-play-dialog" class="dialog-close-btn">√ó</button><h2>How to Play Color Trading</h2><div class="dialog-content"><h3>Game Rules</h3><p>Every 1 minute, a new round starts. You have 55 seconds to place a bet on the outcome. The result is a number from 0 to 9.</p><h3>Betting Options & Payouts</h3><ul><li><strong>Colors (Green/Red):</strong> Bet on a color. If the result is the correct color, you get <strong>2x</strong> your bet. (e.g., bet ‚Çπ10, win ‚Çπ20).</li><li><strong>Violet:</strong> If the result is a number that is both Green/Red and Violet (0 or 5), and you bet on Violet, you get <strong>4.5x</strong> your bet.</li><li><strong>Numbers (0-9):</strong> Bet on a specific number. If you guess correctly, you get <strong>9x</strong> your bet.</li><li><strong>Size (Big/Small):</strong> Bet on whether the number will be Big (5-9) or Small (0-4). If correct, you get <strong>2x</strong> your bet.</li></ul><h3>Color & Size Chart</h3><ul><li><strong style="color:var(--accent-green)">Green:</strong> 1, 3, 7, 9</li><li><strong style="color:var(--accent-red)">Red:</strong> 2, 4, 6, 8</li><li><strong style="color:var(--accent-purple)">Violet:</strong> 0, 5</li><li><strong style="color:var(--accent-blue)">Small:</strong> 0, 1, 2, 3, 4</li><li><strong style="color:var(--accent-yellow)">Big:</strong> 5, 6, 7, 8, 9</li></ul><h3>Special Case Example</h3><p>The number 5 is Red and Violet. If you bet ‚Çπ10 on Red, you win ‚Çπ15 (1.5x). If you bet ‚Çπ10 on Violet, you win ‚Çπ45 (4.5x). If you bet on Big, you win ‚Çπ20 (2x).</p></div></div></div>

    </div>

<script>
    // =========== SOUND EFFECT ENGINE ===========
    let isMuted = false;
    const soundEffects = {
        click: new Audio('https://cdn.pixabay.com/download/audio/2021/08/04/audio_bb630cc098.mp3'),
        bet: new Audio('https://cdn.pixabay.com/download/audio/2022/03/07/audio_2747a32a2d.mp3'),
        win: new Audio('https://cdn.pixabay.com/download/audio/2022/03/15/audio_2b68c40131.mp3'),
        lose: new Audio('https://cdn.pixabay.com/download/audio/2022/03/10/audio_c970a047a2.mp3'),
        gem: new Audio('https://cdn.pixabay.com/download/audio/2022/01/18/audio_7354de7365.mp3'),
        bomb: new Audio('https://cdn.pixabay.com/download/audio/2021/08/04/audio_12b0c342f7.mp3'),
        cashout: new Audio('https://cdn.pixabay.com/download/audio/2022/03/07/audio_2747a32a2d.mp3'),
        tick: new Audio('https://cdn.pixabay.com/download/audio/2022/11/22/audio_2c8a3ce2b9.mp3'),
        pop: new Audio('https://cdn.pixabay.com/download/audio/2022/03/15/audio_1731a6136a.mp3'),
        spinLoop: new Audio('https://cdn.pixabay.com/download/audio/2022/07/16/audio_a168c48a7b.mp3'),
        reelStop: new Audio('https://cdn.pixabay.com/download/audio/2022/03/13/audio_23c893d56a.mp3'),
        inflateLoop: new Audio('https://cdn.pixabay.com/download/audio/2022/08/03/audio_92de418d10.mp3'),
        kenoDraw: new Audio('https://cdn.pixabay.com/download/audio/2021/08/04/audio_165a898a96.mp3'),
    };
    soundEffects.spinLoop.loop = true;
    soundEffects.inflateLoop.loop = true;

    function playSound(soundName) {
        if (isMuted || !soundEffects[soundName]) return;
        const sound = soundEffects[soundName];
        sound.currentTime = 0;
        sound.play().catch(e => {}); // Catch errors for user interactions before sound is ready
    }

    function stopSound(soundName) {
        if (!soundEffects[soundName]) return;
        const sound = soundEffects[soundName];
        sound.pause();
        sound.currentTime = 0;
    }

    document.addEventListener('DOMContentLoaded', () => {
        const muteBtn = document.getElementById('mute-btn');
        if (muteBtn) {
            muteBtn.addEventListener('click', () => {
                isMuted = !isMuted;
                muteBtn.textContent = isMuted ? 'üîá' : 'üîä';
                if (isMuted) { Object.keys(soundEffects).forEach(stopSound); }
            });
        }
        document.querySelectorAll('.btn, .nav-link, .game-card, .ct-number-btn, .ct-history-tabs .tab, .keno-number, #copy-upi-btn').forEach(el => {
            el.addEventListener('click', () => playSound('click'));
        });
    });


    // =========== GLOBAL & FIREBASE SCRIPT ===========
    let activeGameLoop = null, activeInterval = null;
    let currentUserUid = null;
    let currentBalance = 0;
    let db, auth;
    let pendingCtBet = null;

    let my_ct_historyListenerActive = false, ct_historyListenerActive = false, allBetsListenerActive = false;
    let leaderboardListenerActive = false, promotionListenerActive = false, transactionListenerActive = false, balanceListenerActive = false;

    const pageTitleEl = document.getElementById("page-title");
    const walletBalanceEl = document.getElementById("wallet_balance");
    const transactionHistoryBody = document.getElementById("transaction_history_body");

    const firebaseConfig = {
            apiKey: 
*AlzaSyBq8eVcHmH7em8DSRFs8JzzVP1AWmv1280
            authDomain: "global-98f25.firebaseapp.com",
            databaseURL:https://ak-earning-bf760-default
            projectId:"ak-earning-bf760",
            storageBucket: "ak-earning-bf760.2
firebasestorage.app"

            messagingSenderId: "18868844294",
            appId: "1:18868844294:web:416125c6e19f1f5dcc9087"
        };

 if (!firebase.apps.length) { firebase.initializeApp(firebaseConfig); }
    auth = firebase.auth();
    db = firebase.database();

    async function updateBalance(amount, description) {
        if (!currentUserUid) return { committed: false, newBalance: 0 };
        const userRef = db.ref('users/' + currentUserUid);
        const { committed, snapshot } = await userRef.child('balance').transaction(currentBal => {
            if (amount < 0 && (currentBal || 0) < Math.abs(amount)) { return; }
            return (currentBal || 0) + amount;
        });
        if (committed && description) {
            const date = new Date();
            const formattedDate = `${date.getHours().toString().padStart(2, '0')}:${date.getMinutes().toString().padStart(2, '0')}`;
            userRef.child('transactions').push({ description, amount, date: formattedDate, timestamp: firebase.database.ServerValue.TIMESTAMP });
        }
        return { committed, newBalance: snapshot.val() };
    }
    
    function initializeUserData(uid) {
        currentUserUid = uid;
        const userRef = db.ref('users/' + uid);
        userRef.once('value', snapshot => { if (!snapshot.exists()) { userRef.set({ balance: 0, email: firebase.auth().currentUser.email }); } });

        if (!balanceListenerActive) {
            balanceListenerActive = true;
            userRef.child('balance').on('value', snapshot => {
                currentBalance = snapshot.val() || 0;
                const formattedBalance = currentBalance.toFixed(2);
                if (walletBalanceEl) walletBalanceEl.textContent = formattedBalance;
                document.querySelectorAll('.game-balance-value').forEach(el => { el.textContent = '‚Çπ' + formattedBalance; });
                const withdrawDialogBalanceEl = document.getElementById('withdraw-dialog-balance');
                if (withdrawDialogBalanceEl) { withdrawDialogBalanceEl.textContent = formattedBalance; }
            });
        }
        
        if (!transactionListenerActive) {
            transactionListenerActive = true;
            const transactionsRef = userRef.child('transactions').orderByChild('timestamp').limitToLast(20);
            if (transactionHistoryBody) transactionHistoryBody.innerHTML = `<tr><td colspan="3"><div class="loader-small"></div></td></tr>`;
            transactionsRef.on('value', snapshot => {
                if (!transactionHistoryBody) return;
                transactionHistoryBody.innerHTML = ""; let transactions = [];
                snapshot.forEach(childSnapshot => { transactions.push(childSnapshot.val()); });
                if (transactions.length === 0) { transactionHistoryBody.innerHTML = '<tr><td colspan="3" style="text-align:center; color: var(--text-secondary);">No transactions yet.</td></tr>'; return; }
                transactions.reverse().forEach(tx => { transactionHistoryBody.innerHTML += `<tr><td>${tx.description}</td><td class="${tx.amount > 0 ? "tx-credit" : "tx-debit"}">${tx.amount > 0 ? "+" : ""}${tx.amount.toFixed(2)}</td><td>${tx.date || '...'}</td></tr>`; });
            });
        }

        if (!my_ct_historyListenerActive) {
            my_ct_historyListenerActive = true;
            const myCtHistoryRef = userRef.child('my_ct_history').orderByChild('period').limitToLast(50);
            myCtHistoryRef.on('value', snapshot => {
                const myHistoryBody = document.getElementById('ct_my_history_body'); if (!myHistoryBody) return;
                myHistoryBody.innerHTML = ''; let history = [];
                snapshot.forEach(child => { history.push(child.val()); });
                history.reverse().forEach(bet => {
                    const resultText = bet.result === 'waiting' ? 'Waiting' : (bet.result > 0 ? `<span style="color:var(--accent-green)">+${bet.result.toFixed(2)}</span>` : `<span style="color:var(--accent-red)">${bet.result.toFixed(2)}</span>`);
                    myHistoryBody.innerHTML += `<tr><td>${bet.period.slice(-4)}</td><td>${bet.value}</td><td>${bet.amount.toFixed(2)}</td><td class="result">${resultText}</td></tr>`;
                });
            });
        }
    }

    function initializePromotionBanner() {
        if (promotionListenerActive) return; promotionListenerActive = true;
        const scrollerWrapper = document.getElementById('promo-scroller-wrapper'), scrollerInner = document.getElementById('promo-scroller-inner'), promoRef = db.ref('admin_controls/promotions');
        promoRef.on('value', snapshot => {
            if (!scrollerInner || !scrollerWrapper) return; scrollerInner.innerHTML = '';
            if (snapshot.exists() && snapshot.numChildren() > 0) {
                snapshot.forEach(childSnapshot => {
                    const banner = childSnapshot.val();
                    if (banner.bannerUrl && banner.linkUrl) {
                        const bannerElement = document.createElement('a'); bannerElement.href = banner.linkUrl; bannerElement.target = '_blank'; bannerElement.rel = 'noopener noreferrer'; bannerElement.className = 'promo-scroller-item'; bannerElement.innerHTML = `<img src="${banner.bannerUrl}" alt="Promotion">`; scrollerInner.appendChild(bannerElement);
                    }
                });
                scrollerWrapper.style.display = 'block';
            } else { scrollerWrapper.style.display = 'none'; }
        });
    }

    function detachFirebaseListeners() {
        if (currentUserUid) { db.ref('users/' + currentUserUid).off(); balanceListenerActive = false; transactionListenerActive = false; my_ct_historyListenerActive = false; }
        if (leaderboardListenerActive) { db.ref('users').off(); leaderboardListenerActive = false; }
        if (promotionListenerActive) { db.ref('admin_controls/promotions').off(); promotionListenerActive = false; }
        if (ct_historyListenerActive) { db.ref('ct_game_history').off(); ct_historyListenerActive = false; }
        if (allBetsListenerActive) { db.ref('all_ct_bets').off(); allBetsListenerActive = false; }
        currentUserUid = null;
    }

    function toggleSidebar() { playSound('click'); document.getElementById("sidebar").classList.toggle("open"); document.getElementById("sidebar-overlay").classList.toggle("open"); }
    document.querySelectorAll(".nav-link").forEach(e => e.addEventListener("click", t => { t.preventDefault(); const n = t.currentTarget.dataset.page; if(n) showPage(n); document.querySelectorAll(".nav-link").forEach(e => e.classList.remove("active")); t.currentTarget.classList.add("active"); if(document.getElementById("sidebar").classList.contains("open")) { toggleSidebar(); } }));
    
    function showPage(pageId) {
        if (window.stopAllGames) stopAllGames();
        document.querySelectorAll(".page").forEach(p => p.classList.remove("active"));
        const targetPage = document.getElementById(pageId);
        if (targetPage) { targetPage.classList.add("active"); }
        const navLink = document.querySelector(`.nav-link[data-page="${pageId}"]`);
        pageTitleEl.textContent = navLink ? navLink.textContent.trim().substring(1).trim() : "Home";
        
        switch (pageId) {
            case "color-trading-page": startColorTradingGame(); break;
            case "mines-game-page": startMinesGame(); break;
            case "leaderboard-page": startLeaderboard(); break;
            case "hotline-page": startHotlineGame(); break;
            case "balloon-page": startBalloonGame(); break;
            case "keno-page": startKenoGame(); break;
        }
    }
    
    auth.onAuthStateChanged(user => {
        const loaderOverlay = document.getElementById('loader-overlay');
        if (loaderOverlay) { loaderOverlay.style.opacity = '0'; setTimeout(() => { loaderOverlay.style.display = 'none'; }, 500); }
        const authContainer = document.getElementById('auth-container'), mainWrapper = document.querySelector('.main-wrapper');
        if (user) {
            authContainer.style.display = 'none'; mainWrapper.style.display = 'flex';
            initializeUserData(user.uid);
            initializeDepositDialog(); initializeWithdrawDialog(); initializeCtConfirmDialog(); initializeCtHowToPlayDialog(); initializePromotionBanner();
            const sidebarHeader = document.querySelector('.sidebar-header h2');
            if (sidebarHeader) { sidebarHeader.innerHTML = `Menu<br><small style="font-size: 0.6em; color: var(--text-secondary);">${user.email}</small>`; }
        } else {
            authContainer.style.display = 'flex'; mainWrapper.style.display = 'none'; detachFirebaseListeners();
            if(document.getElementById("sidebar").classList.contains("open")){ toggleSidebar(); }
            const sidebarHeader = document.querySelector('.sidebar-header h2'); if (sidebarHeader) { sidebarHeader.textContent = 'Pro Hub'; }
        }
    });
    document.getElementById('show-signup').addEventListener('click', (e) => { e.preventDefault(); playSound('click'); document.getElementById('login-form').style.display = 'none'; document.getElementById('signup-form').style.display = 'block'; });
    document.getElementById('show-login').addEventListener('click', (e) => { e.preventDefault(); playSound('click'); document.getElementById('signup-form').style.display = 'none'; document.getElementById('login-form').style.display = 'block'; });
    document.getElementById('signup-btn').addEventListener('click', (e) => { e.preventDefault(); const email = document.getElementById('signup-email').value; const password = document.getElementById('signup-password').value; const errorEl = document.getElementById('signup-error'); errorEl.style.display = 'none'; auth.createUserWithEmailAndPassword(email, password).catch((error) => { errorEl.textContent = error.message; errorEl.style.display = 'block'; }); });
    document.getElementById('login-btn').addEventListener('click', (e) => { e.preventDefault(); const email = document.getElementById('login-email').value; const password = document.getElementById('login-password').value; const errorEl = document.getElementById('login-error'); errorEl.style.display = 'none'; auth.signInWithEmailAndPassword(email, password).catch((error) => { errorEl.textContent = error.message; errorEl.style.display = 'block'; }); });
    document.getElementById('logout-link').addEventListener('click', (e) => { e.preventDefault(); auth.signOut(); });
    function initializeDepositDialog(){const e=document.getElementById("deposit-btn"),t=document.getElementById("deposit-dialog-overlay"),n=document.getElementById("close-deposit-dialog"),o=document.getElementById("copy-upi-btn"),d=document.getElementById("upi-id-text"),i=document.querySelectorAll("#deposit-dialog-overlay .btn-amount"),l=document.getElementById("deposit-amount"),r=document.getElementById("deposit-utr"),a=document.getElementById("submit-deposit-btn");function s(){t.classList.add("show")}function c(){t.classList.remove("show"),l.value="",r.value=""}e.addEventListener("click",s),n.addEventListener("click",c),t.addEventListener("click",e=>{e.target===t&&c()}),o.addEventListener("click",()=>{navigator.clipboard.writeText(d.textContent).then(()=>{o.textContent="Copied!",setTimeout(()=>{o.textContent="Copy"},2e3)})}),i.forEach(e=>{e.addEventListener("click",()=>{l.value=e.textContent.replace("‚Çπ","")})}),a.addEventListener("click",()=>{const e=parseFloat(l.value),t=r.value.trim();(isNaN(e)||e 300?alert("Minimum deposit amount is ‚Çπ400."):t&&12<=t.length?currentUserUid?db.ref("deposit_requests/"+currentUserUid).push().set({amount:e,utr:t,status:"pending",timestamp:firebase.database.ServerValue.TIMESTAMP,userEmail:auth.currentUser.email}).then(()=>{alert("Deposit request submitted!"),c()}).catch(e=>{alert("Error submitting request: "+e.message)}):alert("You must be logged in."):alert("Please enter a valid 12-digit UTR/Transaction ID."))})}
    function initializeWithdrawDialog(){const e=document.getElementById("withdraw-btn"),t=document.getElementById("withdraw-dialog-overlay"),n=document.getElementById("close-withdraw-dialog"),o=document.getElementById("submit-withdraw-btn"),d=document.getElementById("withdraw-upi"),i=document.getElementById("withdraw-amount"),l=document.getElementById("withdraw-dialog-balance"),r=document.getElementById("withdraw-confirm-dialog-overlay"),a=document.getElementById("confirm-withdraw-amount"),s=document.getElementById("confirm-withdraw-upi"),c=document.getElementById("confirm-withdraw-btn"),u=document.getElementById("cancel-withdraw-confirmation");function m(){l.textContent=currentBalance.toFixed(2),t.classList.add("show")}function p(){t.classList.remove("show"),d.value="",i.value=""}function f(){r.classList.add("show")}function g(){r.classList.remove("show")}e.addEventListener("click",m),n.addEventListener("click",p),t.addEventListener("click",e=>{e.target===t&&p()}),u.addEventListener("click",g),o.addEventListener("click",()=>{const e=d.value.trim(),t=parseFloat(i.value);currentUserUid?e.length<3||!e.includes("@")?alert("Please enter a valid UPI ID (e.g., yourname@bank)."):isNaN(t)||t<100?alert("Minimum withdrawal amount is ‚Çπ550."):t>currentBalance?alert("Insufficient balance."):(a.textContent=`‚Çπ${t.toFixed(2)}`,s.textContent=e,f()):alert("You must be logged in.")}),c.addEventListener("click",async()=>{const e=d.value.trim(),t=parseFloat(i.value);c.disabled=!0,c.textContent="Processing...";try{const{committed:n}=await updateBalance(-t,"Withdrawal Request");if(!n)throw new Error("Transaction failed. Insufficient funds.");await db.ref("withdraw_requests/"+currentUserUid).push().set({upiNumber:e,amount:t,status:"pending",timestamp:firebase.database.ServerValue.TIMESTAMP,userEmail:auth.currentUser.email}),alert("Withdrawal request submitted! The amount has been deducted from your balance."),g(),p()}catch(e){alert(`An error occurred: ${e.message}`),g()}finally{c.disabled=!1,c.textContent="Confirm"}})}
    function initializeCtHowToPlayDialog(){const e=document.getElementById("ct-how-to-play-overlay"),t=document.getElementById("ct_how_to_play_btn"),n=document.getElementById("close-how-to-play-dialog");if(e&&t&&n){function o(){e.classList.add("show")}function d(){e.classList.remove("show")}t.addEventListener("click",o),n.addEventListener("click",d),e.addEventListener("click",e=>{e.target===e&&d()})}}

    function startLeaderboard(){if(leaderboardListenerActive)return;const e=document.getElementById("leaderboard_body");e&&(leaderboardListenerActive=!0,e.innerHTML='<tr><td colspan="3"><div class="loader-small"></div></td></tr>',db.ref("users").orderByChild("balance").limitToLast(10).on("value",t=>{let n=[];t.forEach(e=>{const t=e.val();t.balance>0&&n.unshift({email:t.email,balance:t.balance})}),e.innerHTML="",0===n.length?e.innerHTML='<tr><td colspan="3" style="text-align:center; color: var(--text-secondary);">No players on the board yet.</td></tr>':n.forEach((t,n)=>{const o=n+1,d=t.email?t.email.replace(/^(...).*?(@.*)$/,"$1***$2"):"Anonymous",i=t.balance?t.balance.toFixed(2):"0.00";e.innerHTML+=`<tr><td>${o}</td><td>${d}</td><td>‚Çπ${i}</td></tr>`})},e=>{console.error("Error fetching leaderboard data:",e),e.innerHTML='<tr><td colspan="3" style="text-align:center; color: var(--text-red);">Error loading data.</td></tr>',leaderboardListenerActive=!1}))}
    const ct_els={timer:document.getElementById("ct_timer"),period:document.getElementById("ct_period"),betAmountInput:document.getElementById("ct_bet_amount"),numberGrid:document.getElementById("ct_number_grid"),gameHistoryBody:document.getElementById("ct_game_history_body"),myHistoryBody:document.getElementById("ct_my_history_body"),tabs:document.querySelectorAll(".ct-history-tabs .tab"),historyContents:document.querySelectorAll(".ct-history-content"),dialogOverlay:document.getElementById("ct_dialog_overlay"),winDialog:document.querySelector("#ct_dialog_overlay .win-dialog"),lossDialog:document.querySelector("#ct_dialog_overlay .loss-dialog"),autoToggle:document.getElementById("ct_auto_toggle"),autoPanel:document.getElementById("ct_auto_panel"),autoRoundsInput:document.getElementById("ct_auto_rounds"),autoStrategySelect:document.getElementById("ct_auto_strategy"),autoActionBtn:document.getElementById("ct_auto_action_btn"),allBettingControls:document.querySelectorAll("#color-trading-page button, #color-trading-page input, #color-trading-page select")};function initializeCtConfirmDialog(){const e=document.getElementById("ct-confirm-dialog-overlay"),t=document.getElementById("confirm-ct-bet-btn"),n=document.getElementById("cancel-ct-confirmation");function o(){e.classList.remove("show"),pendingCtBet=null}n.addEventListener("click",o),e.addEventListener("click",e=>{e.target===e&&o()}),t.addEventListener("click",async()=>{pendingCtBet&&(t.disabled=!0,t.textContent="Processing...",await ct_executeBetTransaction(pendingCtBet.type,pendingCtBet.value,pendingCtBet.amount),t.disabled=!1,t.textContent="Confirm Bet",o())})}async function ct_executeBetTransaction(e,t,n){try{const{committed:o}=await updateBalance(-n,`CT Bet: ${t}`);if(!o)return alert("Bet failed due to insufficient funds."),!1;playSound('bet');const d={period:ct_periodId,type:e,value:t,amount:n,result:"waiting",timestamp:firebase.database.ServerValue.TIMESTAMP},i={email:auth.currentUser.email,selection:t,amount:n,timestamp:firebase.database.ServerValue.TIMESTAMP};return await Promise.all([db.ref(`users/${currentUserUid}/my_ct_history`).push(d),db.ref("all_ct_bets").push(i)]),!0}catch(e){return console.error("Betting Error:",e),alert(`Error placing bet: ${e.message}`),!1}}let ct_periodId,ct_countdown,ct_isRoundEnding=!1,ct_isAutoPlaying=!1,ct_autoRoundsLeft=0,ct_autoPlayTimeout=null;const ct_colorMap={0:"rv",1:"g",2:"r",3:"g",4:"r",5:"gv",6:"r",7:"g",8:"r",9:"g"};function ct_hideDialog(){ct_els.dialogOverlay.classList.remove("show"),ct_isRoundEnding=!1,startColorTradingGame()}function ct_showDialog(e,t){const n="win"===e?ct_els.winDialog:ct_els.lossDialog,o="loss"===e?ct_els.winDialog:ct_els.lossDialog;o.style.display="none",n.style.display="block";const d=t.winColors.find(e=>"Violet"!==e)||t.winColors[0];document.getElementById(`ct_${e}_dialog_color`).textContent=d,document.getElementById(`ct_${e}_dialog_number`).textContent=t.winNum,document.getElementById(`ct_${e}_dialog_size`).textContent=t.winSize,document.getElementById(`ct_${e}_dialog_period`).textContent=t.period.slice(-4),"win"===e?document.getElementById("ct_win_dialog_bonus").textContent=`+‚Çπ${t.netChange.toFixed(2)}`:document.getElementById("ct_loss_dialog_amount").textContent=`-‚Çπ${Math.abs(t.netChange).toFixed(2)}`,ct_els.dialogOverlay.classList.add("show")}function ct_placeBet(e,t){if(ct_countdown<=5||ct_isAutoPlaying||ct_isRoundEnding)return;playSound('click');const n=parseFloat(ct_els.betAmountInput.value);isNaN(n)||n<=0?alert("Please enter a valid bet amount."):n>currentBalance?alert("Insufficient balance."):(pendingCtBet={type:e,value:t,amount:n},document.getElementById("confirm-ct-bet-amount").textContent=`‚Çπ${n.toFixed(2)}`,document.getElementById("confirm-ct-bet-selection").textContent=t,document.getElementById("ct-confirm-dialog-overlay").classList.add("show"))}window.ct_stopAutoPlay=function(e){ct_isAutoPlaying&&(ct_isAutoPlaying=!1,clearTimeout(ct_autoPlayTimeout),ct_els.autoActionBtn.textContent="Start Auto Play",ct_els.autoActionBtn.className="btn btn-green",ct_els.allBettingControls.forEach(e=>{e.id==="ct_auto_action_btn"||e.id==="ct_auto_toggle"||e.closest("#ct_auto_panel")||(e.disabled=!1)}),e&&alert(e))};
    function startColorTradingGame(){
        if(ct_isRoundEnding)return;
        if (!ct_els.numberGrid.dataset.initialized) {
            ct_els.numberGrid.innerHTML = '';
            const numberImageUrls = [ 'https://i.ibb.co/JWsTpKzy/file-00000000888c61f5b9918f5f0c5e441c.png', 'https://i.ibb.co/rG4V1V6x/file-00000000743c622f8a519067b7a6b01b.png', 'https://i.ibb.co/8LTg2N47/file-000000005a6062308b7e60f5c324a9d5.png', 'https://i.ibb.co/wFsHrRsg/file-00000000f4a861f7bd5e2241fbe89e1b.png', 'https://i.ibb.co/fdn9r4fW/file-000000007408622f82d0e1ccf9b10671.png', 'https://i.ibb.co/jc6z0y7/file-00000000efe46230882776e4c018472f.png', 'https://i.ibb.co/YYqL9k4/file-00000000f16861f8b7a2c3379a2662f1.png', 'https://i.ibb.co/99p2dXmV/file-0000000037a461f88abc1709c2401377.png', 'https://i.ibb.co/LzVwH4Xb/file-000000003fa061f88628919a9560b7f7.png', 'https://i.ibb.co/DgYwxN7r/file-00000000e8546230b05909132da85d93.png' ];
            for (let e = 0; e <= 9; e++) {
                const button = document.createElement("button"); button.className = "ct-number-btn";
                const img = document.createElement('img'); img.src = numberImageUrls[e]; img.alt = `Number ${e}`; button.appendChild(img);
                button.onclick = () => ct_placeBet("number", e); ct_els.numberGrid.appendChild(button);
            }
            ct_els.numberGrid.dataset.initialized = "true";
        }
        function e(){const e=ct_els.autoStrategySelect.value;let t="color",n="Green";switch(e){case"Red":n="Red";break;case"Violet":n="Violet";break;case"Big":t="size",n="Big";break;case"Small":t="size",n="Small";break;case"random_color":n=["Green","Red","Violet"][Math.floor(3*Math.random())];break;case"random_number":t="number",n=Math.floor(10*Math.random())}return{type:t,value:n}}async function t(){const t=parseFloat(ct_els.betAmountInput.value);if(currentBalance<t)return void ct_stopAutoPlay("Auto-play stopped: insufficient funds.");const{type:n,value:o}=e();await ct_executeBetTransaction(n,o,t)?(ct_autoRoundsLeft--,ct_isAutoPlaying&&(ct_els.autoActionBtn.textContent=`Running... (${ct_autoRoundsLeft} left)`)):ct_stopAutoPlay("Auto-play stopped: betting error.")}function n(){ct_countdown>15&&(ct_autoPlayTimeout=setTimeout(t,1e3*(ct_countdown-15)+5e3*Math.random()))}function o(){const e=parseInt(ct_els.autoRoundsInput.value),t=parseFloat(ct_els.betAmountInput.value);isNaN(e)||e<1?alert("Invalid number of rounds."):isNaN(t)||t<=0?alert("Invalid bet amount."):t>currentBalance?alert("Insufficient balance to start auto-play."):(ct_isAutoPlaying=!0,ct_autoRoundsLeft=e,ct_els.autoActionBtn.textContent=`Running... (${ct_autoRoundsLeft} left)`,ct_els.autoActionBtn.className="btn btn-red",ct_els.allBettingControls.forEach(e=>{"ct_auto_action_btn"===e.id||"ct_auto_toggle"===e.id||(e.disabled=!0)}),n())}ct_els.autoToggle.dataset.listenerAttached||(ct_els.autoToggle.addEventListener("change",()=>{ct_els.autoPanel.style.display=ct_els.autoToggle.checked?"block":"none",ct_els.autoToggle.checked||ct_stopAutoPlay()}),ct_els.autoActionBtn.addEventListener("click",()=>{ct_isAutoPlaying?ct_stopAutoPlay("Auto-play stopped by user."):o()}),ct_els.autoToggle.dataset.listenerAttached="true"),clearInterval(activeInterval),activeInterval=null;const d=new Date;ct_periodId=`${d.getFullYear()}${(d.getMonth()+1).toString().padStart(2,"0")}${d.getDate().toString().padStart(2,"0")}${String(Math.floor(d.getUTCHours()*60+d.getUTCMinutes())).padStart(4,"0")}`,ct_els.period.textContent=ct_periodId,ct_countdown=60-d.getSeconds(),ct_isRoundEnding=!1,activeInterval=setInterval(()=>{ct_countdown--;const e=(ct_countdown%60).toString().padStart(2,"0");ct_els.timer.textContent=`00:${e}`;const t=ct_countdown<=5||ct_isRoundEnding;ct_els.allBettingControls.forEach(e=>e.disabled=t||ct_isAutoPlaying),ct_els.timer.style.color=t?"var(--accent-red)":"white";if(ct_countdown<=10)playSound('tick');if(ct_countdown<=0){clearInterval(activeInterval),activeInterval=null,stopSound('tick'),ct_endRound()}},1e3),ct_isAutoPlaying&&(ct_autoRoundsLeft>0?n():ct_stopAutoPlay("Auto-play finished."));
        if (!ct_historyListenerActive) {
            ct_historyListenerActive = true;
            db.ref('ct_game_history').orderByKey().limitToLast(20).on('value', snapshot => {
                const historyBody = ct_els.gameHistoryBody; if (!historyBody) return; historyBody.innerHTML = ''; let games = [];
                snapshot.forEach(child => { games.push(child.val()); });
                games.reverse().forEach(game => {
                    const resultCircles = game.winColors.map(c => `<span style="color:var(--accent-${"Green"===c?"green":"Red"===c?"red":"purple"}); font-size: 1.5em; line-height: 1;">‚óè</span>`).join('');
                    historyBody.innerHTML += `<tr><td>${game.period.slice(-4)}</td><td>${game.winNum}</td><td>${game.winSize}</td><td>${resultCircles}</td></tr>`;
                });
            });
        }
        if (!allBetsListenerActive) {
            allBetsListenerActive = true;
            const allBetsBody = document.getElementById('ct_all_bets_history_body');
            if (allBetsBody) {
                db.ref('all_ct_bets').orderByChild('timestamp').limitToLast(20).on('value', snapshot => {
                    allBetsBody.innerHTML = ''; let bets = []; snapshot.forEach(child => { bets.push(child.val()); });
                    bets.reverse().forEach(bet => { const maskedEmail = bet.email.replace(/^(...).*?(@.*)$/, "$1***$2"); allBetsBody.innerHTML += `<tr><td>${maskedEmail}</td><td>${bet.selection}</td><td>‚Çπ${bet.amount.toFixed(2)}</td></tr>`; });
                });
            }
        }
    }
    async function ct_endRound(){if(ct_isRoundEnding)return;ct_isRoundEnding=!0;const e=await db.ref("admin_controls/color_trading/next_result").once("value");let t=e.exists()&&null!==e.val()?parseInt(e.val()):Math.floor(10*Math.random());e.exists()&&e.ref.remove();const n=ct_colorMap[t].split("").map(e=>"g"===e?"Green":"r"===e?"Red":"Violet"),o=t>=5?"Big":"Small";await db.ref(`ct_game_history/${ct_periodId}`).set({period:ct_periodId,winNum:t,winSize:o,winColors:n});let d=0,i=!1,l=0;const r=await db.ref(`users/${currentUserUid}/my_ct_history`).orderByChild("period").equalTo(ct_periodId).once("value");if(r.exists()){i=!0;const a=[];r.forEach(e=>{const r=e.val();let s=!1,c=2;l+=r.amount,"color"===r.type?n.includes(r.value)&&(s=!0,"Violet"===r.value?c=4.5:n.includes("Violet")&&(c=1.5)):"number"===r.type?t==r.value&&(s=!0,c=9):"size"===r.type&&o===r.value&&!n.includes("Violet")&&(s=!0);let u=-r.amount;s&&(winnings=r.amount*c,u=winnings-r.amount,a.push(updateBalance(winnings,`CT Win: ${r.value}`))),d+=u,a.push(e.ref.child("result").set(u))}),await Promise.all(a),playSound(d>=0?"win":"lose")}i&&!ct_isAutoPlaying?ct_showDialog(d>=0?"win":"loss",{winNum:t,winColors:n,winSize:o,netChange:d>=0?d:l,period:ct_periodId}):(ct_isRoundEnding=!1,setTimeout(startColorTradingGame,3e3))}function ct_multiplyBet(e){if(ct_isAutoPlaying||ct_isRoundEnding)return;playSound('click');const t=parseFloat(ct_els.betAmountInput.value)||10;ct_els.betAmountInput.value=(t*e).toFixed(0)}
    ct_els.tabs.forEach(e=>{e.addEventListener("click",()=>{ct_els.tabs.forEach(e=>e.classList.remove("active")),e.classList.add("active"),ct_els.historyContents.forEach(e=>e.classList.remove("active")),document.getElementById(e.dataset.tab).classList.add("active")})});
    
    let mines_isManualGameActive=!1,mines_isAutoBettingActive=!1,mines_autoBetTimeout=null,mines_currentBet=0,mines_uncoveredGems=0,mines_minePositions=new Set,mines_profitMultiplier=1,mines_autoGamesLeft=0;function mines_hideDialog(){document.getElementById("mines_dialog_overlay").classList.remove("show"),mines_isAutoBettingActive||startMinesGame()}window.mines_stopAutoBet=e=>{mines_isAutoBettingActive&&(mines_isAutoBettingActive=!1,mines_autoGamesLeft=0,clearTimeout(mines_autoBetTimeout),updateMinesActionButtonState(),e&&alert(e))};function startMinesGame(){resetMinesGameUI();const e=document.getElementById("mines_auto_toggle");e.dataset.listenerAttached||(e.addEventListener("change",()=>{document.getElementById("mines_auto_panel").style.display=e.checked?"block":"none",e.checked||window.mines_stopAutoBet(),updateMinesActionButtonState()}),document.getElementById("mines_action_btn").addEventListener("click",handleMinesActionClick),e.dataset.listenerAttached="true")}function updateMinesActionButtonState(){const e=document.getElementById("mines_action_btn"),t=document.getElementById("mines_betAmount"),n=document.getElementById("mines_mineCount"),o=document.getElementById("mines_auto_toggle"),d=document.getElementById("mines_auto_panel"),i=[t,n,o,...d.querySelectorAll("input")];mines_isAutoBettingActive?(e.textContent=`STOP AUTO (${mines_autoGamesLeft} left)`,e.className="btn btn-red",i.forEach(e=>e.disabled=!0)):mines_isManualGameActive?(e.textContent=`CASHOUT (‚Çπ${(mines_currentBet*mines_profitMultiplier).toFixed(2)})`,e.className="btn btn-primary",[t,n,o].forEach(e=>e.disabled=!0)):(e.className="btn btn-green",e.textContent=o.checked?"START AUTO BET":"BET",i.forEach(e=>e.disabled=!1)),e.disabled=!1}function resetMinesGameUI(){const e=document.getElementById("mines_grid");e.innerHTML="",mines_isManualGameActive=!1,mines_currentBet=0,mines_uncoveredGems=0,mines_minePositions.clear(),mines_profitMultiplier=1,document.getElementById("mines_next_profit").textContent="--",document.getElementById("mines_total_profit").textContent="--";for(let t=0;t<25;t++){const n=document.createElement("div");n.className="mine-tile",n.dataset.index=t,n.innerHTML='<div class="face front"></div><div class="face back"></div>',e.appendChild(n)}updateMinesActionButtonState()}function showMinesDialog(e,t){const n=document.getElementById("mines_dialog_overlay"),o=document.querySelector("#mines_dialog_overlay .mines-win-dialog"),d=document.querySelector("#mines_dialog_overlay .mines-loss-dialog");"win"===e?(playSound('win'),document.getElementById("mines_win_dialog_profit").textContent=`+‚Çπ${t.profit.toFixed(2)}`,d.style.display="none",o.style.display="block"):(playSound('lose'),document.getElementById("mines_loss_dialog_amount").textContent=`-‚Çπ${t.betAmount.toFixed(2)}`,o.style.display="none",d.style.display="block"),n.classList.add("show")}function calculateMinesMultiplier(e,t){if(0===e)return 1;let n=1;for(let o=0;o<e;o++)n*=(25-t-o)/(25-o);return.95/n}function updateMinesProfitInfo(){const e=parseInt(document.getElementById("mines_mineCount").value),t=mines_currentBet,n=calculateMinesMultiplier(mines_uncoveredGems+1,e),o=t*n,d=t*mines_profitMultiplier;document.getElementById("mines_next_profit").textContent=`‚Çπ${(o-d).toFixed(2)}`,document.getElementById("mines_total_profit").textContent=`‚Çπ${d.toFixed(2)}`}function handleMinesActionClick(){playSound('click');document.getElementById("mines_auto_toggle").checked?mines_isAutoBettingActive?window.mines_stopAutoBet("Auto-bet stopped by user."):startMinesAutoBet():handleManualMinesBet()}async function handleManualMinesBet(){const e=document.getElementById("mines_action_btn");if(mines_isManualGameActive){e.disabled=!0;playSound("cashout");const t=mines_currentBet*mines_profitMultiplier,n=t-mines_currentBet;await updateBalance(t,"Mines Cashout"),showMinesDialog("win",{profit:n}),mines_isManualGameActive=!1}else{const t=parseFloat(document.getElementById("mines_betAmount").value),n=parseInt(document.getElementById("mines_mineCount").value);if(isNaN(t)||t<=0||t>currentBalance)return void alert("Invalid bet or insufficient balance");if(isNaN(n)||n<1||n>20)return void alert("Mine count must be 1-20.");e.disabled=!0;const{committed:o}=await updateBalance(-t,"Mines Bet");o?(playSound("bet"),mines_currentBet=t,mines_isManualGameActive=!0,mines_minePositions.clear(),(()=>{for(;mines_minePositions.size<n;)mines_minePositions.add(Math.floor(25*Math.random()))})(),updateMinesProfitInfo(),updateMinesActionButtonState(),document.querySelectorAll(".mine-tile").forEach(e=>e.onclick=()=>onMinesTileClick(e))):(alert("Bet failed due to insufficient funds."),e.disabled=!1)}}function onMinesTileClick(e){if(!mines_isManualGameActive||e.classList.contains("revealed"))return;e.classList.add("revealed");const t=parseInt(e.dataset.index);if(mines_minePositions.has(t)){playSound("bomb"),e.classList.add("bomb"),mines_isManualGameActive=!1,document.getElementById("mines_grid").classList.add("shake-effect"),setTimeout(()=>document.getElementById("mines_grid").classList.remove("shake-effect"),500),document.querySelectorAll(".mine-tile").forEach(e=>{mines_minePositions.has(parseInt(e.dataset.index))&&e.classList.add("revealed","bomb")}),showMinesDialog("loss",{betAmount:mines_currentBet})}else{playSound("gem"),e.classList.add("gem"),mines_uncoveredGems++,mines_profitMultiplier=calculateMinesMultiplier(mines_uncoveredGems,parseInt(document.getElementById("mines_mineCount").value)),updateMinesProfitInfo(),updateMinesActionButtonState()}}function startMinesAutoBet(){const e=parseInt(document.getElementById("mines_auto_games").value);isNaN(e)||e<1?alert("Invalid number of games."):(mines_isAutoBettingActive=!0,mines_autoGamesLeft=e,updateMinesActionButtonState(),runMinesAutoBetGame())}async function runMinesAutoBetGame(){if(mines_isAutoBettingActive&&mines_autoGamesLeft>0){resetMinesGameUI(),await new Promise(e=>setTimeout(e,500));const e=parseFloat(document.getElementById("mines_betAmount").value),t=parseInt(document.getElementById("mines_mineCount").value),n=parseInt(document.getElementById("mines_auto_picks").value);if(e>currentBalance)return void window.mines_stopAutoBet("Auto-bet stopped: insufficient funds.");if(isNaN(n)||n<1||n>=25-t)return alert(`Gems to pick must be between 1 and ${24-t}.`),void window.mines_stopAutoBet();const{committed:o}=await updateBalance(-e,"Mines Auto Bet");if(!o)return void window.mines_stopAutoBet("Auto-bet stopped: bet failed.");playSound("bet"),mines_minePositions.clear(),(()=>{for(;mines_minePositions.size<t;)mines_minePositions.add(Math.floor(25*Math.random()))})();let d=Array.from({length:25},(e,t)=>t),i=!1;for(let e=0;e<n;e++){if(!mines_isAutoBettingActive)return;const t=Math.floor(Math.random()*d.length),o=d.splice(t,1)[0],l=document.querySelector(`.mine-tile[data-index='${o}']`);if(l.classList.add("revealed"),await new Promise(e=>setTimeout(e,200)),mines_minePositions.has(o)){l.classList.add("bomb"),i=!0,playSound("bomb");break}l.classList.add("gem"),playSound("gem")}i?playSound("lose"):await updateBalance(e*calculateMinesMultiplier(n,t),"Mines Auto Win").then(()=>playSound("win")),mines_autoGamesLeft--,updateMinesActionButtonState(),mines_autoBetTimeout=setTimeout(runMinesAutoBetGame,2e3)}else window.mines_stopAutoBet("Auto-bet finished."),startMinesGame()}

    let activeGameIntervals = [];
    function stopAllGames() { if (window.ct_stopAutoPlay) ct_stopAutoPlay(); if (window.mines_stopAutoBet) mines_stopAutoBet(); activeGameIntervals.forEach(clearInterval); activeGameIntervals = []; Object.keys(soundEffects).forEach(stopSound); }

    function showGenericDialog(isWin, title, label, amount) { playSound(isWin ? 'win' : 'lose'); const overlay = document.getElementById('generic_dialog_overlay'); const dialogBox = document.getElementById('generic_dialog_box'); document.getElementById('generic_dialog_title').textContent = title; document.getElementById('generic_dialog_icon').textContent = isWin ? 'üéâ' : 'üò¢'; document.getElementById('generic_dialog_label').textContent = label; document.getElementById('generic_dialog_amount').textContent = amount; dialogBox.className = isWin ? 'generic-dialog generic-win-dialog' : 'generic-dialog generic-loss-dialog'; overlay.classList.add('show'); }
    function hideGenericDialog() { document.getElementById('generic_dialog_overlay').classList.remove('show'); }

    async function startHotlineGame() {
        const reels = [document.getElementById('hotline_reel1'), document.getElementById('hotline_reel2'), document.getElementById('hotline_reel3')];
        const spinBtn = document.getElementById('hotline_spin_btn');
        const betAmountInput = document.getElementById('hotline_bet_amount');
        const symbols = [ { id: 'lemon', src: 'https://i.ibb.co/wr8pkJkG/file-0000000075d8622f9ecf6665274a29b4.png', alt: 'lemon' }, { id: 'cherry', src: 'https://i.ibb.co/bgTQ8mzw/file-00000000824461f8a0e0ea62c52ee25b.png', alt: 'cherry' }, { id: 'diamond', src: 'https://i.ibb.co/MD22rXYB/file-00000000ae1061f8acd84b9b9a00963a.png', alt: 'diamond' }, { id: 'seven', src: 'https://i.ibb.co/Xx8zKYV6/file-00000000ec7c61f5a7ee58f274e2b74d.png', alt: 'seven' } ];
        const payouts = { 'lemon': 5, 'cherry': 10, 'diamond': 25, 'seven': 100 };
        if (spinBtn.dataset.listener) return; spinBtn.dataset.listener = true;
        spinBtn.addEventListener('click', async () => {
            const betAmount = parseFloat(betAmountInput.value);
            if (isNaN(betAmount) || betAmount <= 0) { alert('Please enter a valid bet amount.'); return; }
            if (betAmount > currentBalance) { alert('Insufficient balance.'); return; }
            spinBtn.disabled = true; spinBtn.textContent = 'Spinning...';
            const { committed } = await updateBalance(-betAmount, 'Hotline Bet');
            if (!committed) { alert('Bet failed. Please try again.'); spinBtn.disabled = false; spinBtn.textContent = 'Spin'; return; }
            playSound('bet'); playSound('spinLoop');
            const adminResultRef = db.ref('admin_controls/hotline/next_result'); const adminSnapshot = await adminResultRef.once('value'); let finalSymbols = [];
            if (adminSnapshot.exists() && Array.isArray(adminSnapshot.val()) && adminSnapshot.val().length === 3) {
                const adminSymbolIds = adminSnapshot.val(); finalSymbols = adminSymbolIds.map(id => symbols.find(s => s.id === id)).filter(Boolean);
                if (finalSymbols.length !== 3) { finalSymbols = [symbols[Math.floor(Math.random() * symbols.length)], symbols[Math.floor(Math.random() * symbols.length)], symbols[Math.floor(Math.random() * symbols.length)]]; }
                adminResultRef.remove();
            } else { finalSymbols = [symbols[Math.floor(Math.random() * symbols.length)], symbols[Math.floor(Math.random() * symbols.length)], symbols[Math.floor(Math.random() * symbols.length)]]; }
            reels.forEach((reel, index) => {
                const interval = setInterval(() => { const randomSymbol = symbols[Math.floor(Math.random() * symbols.length)]; reel.innerHTML = `<img src="${randomSymbol.src}" alt="${randomSymbol.alt}">`; }, 100);
                setTimeout(() => {
                    clearInterval(interval); playSound('reelStop');
                    const finalSymbol = finalSymbols[index]; reel.innerHTML = `<img src="${finalSymbol.src}" alt="${finalSymbol.alt}">`;
                    if (index === reels.length - 1) { stopSound('spinLoop'); checkWin(finalSymbols, betAmount); }
                }, 1000 + index * 500);
            });
        });
        async function checkWin(finalSymbols, betAmount) {
            const isWin = finalSymbols.every(s => s.id === finalSymbols[0].id);
            if (isWin) { const prize = betAmount * payouts[finalSymbols[0].id]; await updateBalance(prize, 'Hotline Win'); showGenericDialog(true, 'Jackpot!', 'You Won', `+‚Çπ${(prize - betAmount).toFixed(2)}`);
            } else { showGenericDialog(false, 'So Close!', 'You Lost', `-‚Çπ${betAmount.toFixed(2)}`); }
            spinBtn.disabled = false; spinBtn.textContent = 'Spin';
        }
    }
    
    function startBalloonGame() {
        const actionBtn = document.getElementById('balloon_action_btn'); const betAmountInput = document.getElementById('balloon_bet_amount');
        const multiplierEl = document.getElementById('balloon_multiplier'); const statusEl = document.getElementById('balloon_status');
        const iconEl = document.getElementById('balloon_icon'); let gameActive = false, multiplier = 1.00;
        const resetGame = () => { gameActive = false; stopAllGames(); multiplier = 1.00; multiplierEl.textContent = '1.00x'; multiplierEl.style.color = 'var(--accent-green)'; statusEl.textContent = 'Place your bet to start'; actionBtn.textContent = 'Bet'; actionBtn.className = 'btn btn-green'; actionBtn.disabled = false; betAmountInput.disabled = false; iconEl.classList.remove('rising'); iconEl.textContent = 'üéà'; };
        if (actionBtn.dataset.listener) return; actionBtn.dataset.listener = true;
        actionBtn.addEventListener('click', async () => {
            if (!gameActive) {
                const betAmount = parseFloat(betAmountInput.value);
                if (isNaN(betAmount) || betAmount <= 0) { alert('Please enter a valid bet amount.'); return; }
                if (betAmount > currentBalance) { alert('Insufficient balance.'); return; }
                const { committed } = await updateBalance(-betAmount, 'Balloon Bet'); if (!committed) { alert('Bet failed.'); return; }
                playSound('bet'); playSound('inflateLoop'); gameActive = true; betAmountInput.disabled = true;
                actionBtn.textContent = 'Cashout at 1.00x'; actionBtn.className = 'btn btn-primary'; statusEl.textContent = 'Balloon is rising...'; iconEl.classList.add('rising');
                const adminResultRef = db.ref('admin_controls/balloon/next_pop_multiplier'); const adminSnapshot = await adminResultRef.once('value'); let popMultiplier = 0;
                if (adminSnapshot.exists()) { popMultiplier = parseFloat(adminSnapshot.val()); adminResultRef.remove(); } else { popMultiplier = 1 + Math.random() * 10; }
                const gameInterval = setInterval(() => {
                    if (!gameActive) return; multiplier += 0.01 + (multiplier / 50);
                    multiplierEl.textContent = `${multiplier.toFixed(2)}x`; actionBtn.textContent = `Cashout at ${multiplier.toFixed(2)}x`;
                    if (multiplier >= popMultiplier) { stopSound('inflateLoop'); playSound('pop'); stopAllGames(); gameActive = false; statusEl.textContent = `POPPED at ${multiplier.toFixed(2)}x!`; multiplierEl.style.color = 'var(--accent-red)'; actionBtn.disabled = true; iconEl.classList.remove('rising'); iconEl.textContent = 'üí•'; showGenericDialog(false, 'Popped!', 'You Lost', `-‚Çπ${betAmount.toFixed(2)}`); setTimeout(resetGame, 2000); }
                }, 100); activeGameIntervals.push(gameInterval);
            } else { stopSound('inflateLoop'); playSound('cashout'); stopAllGames(); gameActive = false; const betAmount = parseFloat(betAmountInput.value); const winnings = betAmount * multiplier; await updateBalance(winnings, 'Balloon Win'); showGenericDialog(true, 'Cashed Out!', 'You Won', `+‚Çπ${(winnings - betAmount).toFixed(2)}`); resetGame(); }
        });
        resetGame();
    }

    function startKenoGame() {
        const grid = document.getElementById('keno_grid'); const infoEl = document.getElementById('keno_info');
        const drawBtn = document.getElementById('keno_draw_btn'); const betAmountInput = document.getElementById('keno_bet_amount');
        let selectedNumbers = new Set(); let isDrawing = false;
        const resetGrid = () => { isDrawing = false; grid.innerHTML = ''; for (let i = 1; i <= 40; i++) { const numEl = document.createElement('div'); numEl.className = 'keno-number'; numEl.textContent = i; numEl.addEventListener('click', () => { if (!isDrawing) toggleNumber(numEl, i); }); grid.appendChild(numEl); } };
        const toggleNumber = (el, num) => { playSound('click'); if (selectedNumbers.has(num)) { selectedNumbers.delete(num); el.classList.remove('selected'); } else { if (selectedNumbers.size < 10) { selectedNumbers.add(num); el.classList.add('selected'); } else { alert('You can only select up to 10 numbers.'); } } infoEl.textContent = `Selected ${selectedNumbers.size}/10 numbers.`; };
        if (drawBtn.dataset.listener) return; drawBtn.dataset.listener = true;
        drawBtn.addEventListener('click', async () => {
            const betAmount = parseFloat(betAmountInput.value);
            if (isNaN(betAmount) || betAmount <= 0) { alert('Please enter a valid bet amount.'); return; }
            if (selectedNumbers.size === 0) { alert('Please select at least one number.'); return; }
            if (betAmount > currentBalance) { alert('Insufficient balance.'); return; }
            isDrawing = true; drawBtn.disabled = true; drawBtn.textContent = 'Drawing...';
            const { committed } = await updateBalance(-betAmount, 'Keno Bet');
            if (!committed) { alert('Bet failed.'); drawBtn.disabled = false; drawBtn.textContent = 'Start Draw'; isDrawing = false; return; }
            playSound('bet');
            const adminResultRef = db.ref('admin_controls/keno/next_drawn_numbers'); const adminSnapshot = await adminResultRef.once('value'); let drawnNumbers = new Set();
            if (adminSnapshot.exists() && Array.isArray(adminSnapshot.val())) { adminSnapshot.val().forEach(n => drawnNumbers.add(n)); adminResultRef.remove(); } else { while (drawnNumbers.size < 10) { drawnNumbers.add(Math.floor(Math.random() * 40) + 1); } }
            let matches = 0; const allNumbers = grid.querySelectorAll('.keno-number'); const drawnArray = Array.from(drawnNumbers);
            for(let i = 0; i < drawnArray.length; i++){
                const num = drawnArray[i]; const el = allNumbers[num - 1];
                await new Promise(r => setTimeout(r, 150)); playSound('kenoDraw');
                el.classList.add('drawn'); if(selectedNumbers.has(num)){ el.classList.add('matched'); matches++; }
            }
            const payouts = { 0: 0, 1: 0, 2: 0.5, 3: 1, 4: 2, 5: 5, 6: 10, 7: 20, 8: 50, 9: 100, 10: 200 };
            const multiplier = payouts[matches] || 0; const winnings = betAmount * multiplier;
            setTimeout(async () => {
                if (winnings > 0) { await updateBalance(winnings, 'Keno Win'); showGenericDialog(true, `You Matched ${matches}!`, 'You Won', `+‚Çπ${(winnings - betAmount).toFixed(2)}`);
                } else { showGenericDialog(false, 'No Luck!', 'You Lost', `-‚Çπ${betAmount.toFixed(2)}`); }
                drawBtn.disabled = false; drawBtn.textContent = 'Start Draw'; selectedNumbers.clear(); resetGrid(); infoEl.textContent = 'Selected 0/10 numbers.';
            }, 1500);
        });
        resetGrid();
    }
</script>
</body>
</html>